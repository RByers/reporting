<!doctype html><html lang="en">
 <head>
  <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
  <title>Reporting API</title>
  <meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport">
<style data-fill-with="stylesheet">/******************************************************************************
 *                   Style sheet for the W3C specifications                   *
 *
 * Special classes handled by this style sheet include:
 *
 * Indices
 *   - .toc for the Table of Contents (<ol class="toc">)
 *     + <span class="secno"> for the section numbers
 *   - #toc for the Table of Contents (<nav id="toc">)
 *   - ul.index for Indices (<a href="#ref">term</a><span>, in Â§N.M</span>)
 *   - table.index for Index Tables (e.g. for properties or elements)
 *
 * Structural Markup
 *   - table.data for general data tables
 *     -> use 'scope' attribute, <colgroup>, <thead>, and <tbody> for best results !
 *     -> use <table class='complex data'> for extra-complex tables
 *     -> use <td class='long'> for paragraph-length cell content
 *     -> use <td class='pre'> when manual line breaks/indentation would help readability
 *   - dl.switch for switch statements
 *   - ol.algorithm for algorithms (helps to visualize nesting)
 *   - .figure and .caption (HTML4) and figure and figcaption (HTML5)
 *     -> .sidefigure for right-floated figures
 *   - ins/del
 *
 * Code
 *   - pre and code
 *
 * Special Sections
 *   - .note       for informative notes             (div, p, span, aside, details)
 *   - .example    for informative examples          (div, p, pre, span)
 *   - .issue      for issues                        (div, p, span)
 *   - .assertion  for assertions                    (div, p, span)
 *   - .advisement for loud normative statements     (div, p, strong)
 *   - .annoying-warning for spec obsoletion notices (div, aside, details)
 *
 * Definition Boxes
 *   - pre.def   for WebIDL definitions
 *   - table.def for tables that define other entities (e.g. CSS properties)
 *   - dl.def    for definition lists that define other entitles (e.g. HTML elements)
 *
 * Numbering
 *   - .secno for section numbers in .toc and headings (<span class='secno'>3.2</span>)
 *   - .marker for source-inserted example/figure/issue numbers (<span class='marker'>Issue 4</span>)
 *   - ::before styled for CSS-generated issue/example/figure numbers:
 *     -> Documents wishing to use this only need to add
 *        figcaption::before,
 *        .caption::before { content: "Figure "  counter(figure) " ";  }
 *        .example::before { content: "Example " counter(example) " "; }
 *        .issue::before   { content: "Issue "   counter(issue) " ";   }
 *
 * Header Stuff (ignore, just don't conflict with these classes)
 *   - .head for the header
 *   - .copyright for the copyright
 *
 * Miscellaneous
 *   - .overlarge for things that should be as wide as possible, even if
 *     that overflows the body text area. This can be used on an item or
 *     on its container, depending on the effect desired.
 *     Note that this styling basically doesn't help at all when printing,
 *     since A4 paper isn't much wider than the max-width here.
 *     It's better to design things to fit into a narrower measure if possible.
 *   - js-added ToC jump links (see fixup.js)
 *
 ******************************************************************************/

/******************************************************************************/
/*                                   Body                                     */
/******************************************************************************/

	body {
		counter-reset: example figure issue;

		/* Layout */
		max-width: 50em;               /* limit line length to 50em for readability   */
		margin: 0 auto;                /* center text within page                     */
		padding: 1.6em 1.5em 2em 50px; /* assume 16px font size for downlevel clients */
		padding: 1.6em 1.5em 2em calc(26px + 1.5em); /* leave space for status flag     */

		/* Typography */
		line-height: 1.5;
		font-family: sans-serif;
		widows: 2;
		orphans: 2;
		word-wrap: break-word;
		overflow-wrap: break-word;
		hyphens: auto;

		/* Colors */
		color: black;
		background: white top left fixed no-repeat;
		background-size: 25px auto;
	}


/******************************************************************************/
/*                         Front Matter & Navigation                          */
/******************************************************************************/

/** Header ********************************************************************/

	div.head { margin-bottom: 1em }
	div.head hr { border-style: solid; }

	div.head h1 {
		font-weight: bold;
		margin: 0 0 .1em;
		font-size: 220%;
	}

	div.head h2 { margin-bottom: 1.5em;}

/** W3C Logo ******************************************************************/

	.head .logo {
		float: right;
		margin: 0.4rem 0 0.2rem .4rem;
	}

	.head img[src*="logos/W3C"] {
		display: block;
		border: solid #1a5e9a;
		border-width: .65rem .7rem .6rem;
		border-radius: .4rem;
		background: #1a5e9a;
		color: white;
		font-weight: bold;
	}

	.head a:hover > img[src*="logos/W3C"],
	.head a:focus > img[src*="logos/W3C"] {
		opacity: .8;
	}

	.head a:active > img[src*="logos/W3C"] {
		background: #c00;
		border-color: #c00;
	}

	/* see also additional rules in Link Styling section */

/** Copyright *****************************************************************/

	p.copyright,
	p.copyright small { font-size: small }

/** Back to Top / ToC Toggle **************************************************/

	@media print {
		#toc-nav {
			display: none;
		}
	}
	@media not print {
		#toc-nav {
			position: fixed;
			z-index: 2;
			bottom: 0; left: 0;
			margin: 0;
			min-width: 1.33em;
			border-top-right-radius: 2rem;
			box-shadow: 0 0 2px;
			font-size: 1.5em;
			color: black;
		}
		#toc-nav > a {
			display: block;
			white-space: nowrap;

			height: 1.33em;
			padding: .1em 0.3em;
			margin: 0;

			background: white;
			box-shadow: 0 0 2px;
			border: none;
			border-top-right-radius: 1.33em;
			background: white;
		}
		#toc-nav > #toc-jump {
			padding-bottom: 2em;
			margin-bottom: -1.9em;
		}

		#toc-nav > a:hover,
		#toc-nav > a:focus {
			background: #f8f8f8;
		}
		#toc-nav > a:not(:hover):not(:focus) {
			color: #707070;
		}

		/* statusbar gets in the way on keyboard focus; remove once browsers fix */
		#toc-nav > a[href="#toc"]:not(:hover):focus:last-child {
			padding-bottom: 1.5rem;
		}

		#toc-nav:not(:hover) > a:not(:focus) > span + span {
			/* Ideally this uses :focus-within on #toc-nav */
			display: none;
		}
		#toc-nav > a > span + span {
			padding-right: 0.2em;
		}

		#toc-toggle-inline {
			vertical-align: 0.05em;
			font-size: 80%;
			color: gray;
			color: hsla(203,20%,40%,.7);
			border-style: none;
			background: transparent;
			position: relative;
		}
		#toc-toggle-inline:hover:not(:active),
		#toc-toggle-inline:focus:not(:active) {
			text-shadow: 1px 1px silver;
			top: -1px;
			left: -1px;
		}

		#toc-nav :active {
			color: #C00;
		}
	}

/** ToC Sidebar ***************************************************************/

	/* Floating sidebar */
	@media screen {
		body.toc-sidebar #toc {
			position: fixed;
			top: 0; bottom: 0;
			left: 0;
			width: 23.5em;
			max-width: 80%;
			max-width: calc(100% - 2em - 26px);
			overflow: auto;
			padding: 0 1em;
			padding-left: 42px;
			padding-left: calc(1em + 26px);
			background: inherit;
			background-color: #f7f8f9;
			z-index: 1;
			box-shadow: -.1em 0 .25em rgba(0,0,0,.1) inset;
		}
		body.toc-sidebar #toc h2 {
			margin-top: .8rem;
			font-variant: small-caps;
			font-variant: all-small-caps;
			text-transform: lowercase;
			font-weight: bold;
			color: gray;
			color: hsla(203,20%,40%,.7);
		}
		body.toc-sidebar #toc-jump:not(:focus) {
			width: 0;
			height: 0;
			padding: 0;
			position: absolute;
			overflow: hidden;
		}
	}
	/* Hide main scroller when only the ToC is visible anyway */
	@media screen and (max-width: 28em) {
		body.toc-sidebar {
			overflow: hidden;
		}
	}

	/* Sidebar with its own space */
	@media screen and (min-width: 78em) {
		body:not(.toc-inline) #toc {
			position: fixed;
			top: 0; bottom: 0;
			left: 0;
			width: 23.5em;
			overflow: auto;
			padding: 0 1em;
			padding-left: 42px;
			padding-left: calc(1em + 26px);
			background: inherit;
			background-color: #f7f8f9;
			z-index: 1;
			box-shadow: -.1em 0 .25em rgba(0,0,0,.1) inset;
		}
		body:not(.toc-inline) #toc h2 {
			margin-top: .8rem;
			font-variant: small-caps;
			font-variant: all-small-caps;
			text-transform: lowercase;
			font-weight: bold;
			color: gray;
			color: hsla(203,20%,40%,.7);
		}

		body:not(.toc-inline) {
			padding-left: 29em;
		}
		/* See also Overflow section at the bottom */

		body:not(.toc-inline) #toc-jump:not(:focus) {
			width: 0;
			height: 0;
			padding: 0;
			position: absolute;
			overflow: hidden;
		}
	}
	@media screen and (min-width: 90em) {
		body:not(.toc-inline) {
			margin: 0 4em;
		}
	}

/******************************************************************************/
/*                                Sectioning                                  */
/******************************************************************************/

/** Headings ******************************************************************/

	h1, h2, h3, h4, h5, h6, dt {
		page-break-after: avoid;
		page-break-inside: avoid;
		font: 100% sans-serif;   /* Reset all font styling to clear out UA styles */
		font-family: inherit;    /* Inherit the font family. */
		line-height: 1.2;        /* Keep wrapped headings compact */
		hyphens: manual;         /* Hyphenated headings look weird */
	}

	h2, h3, h4, h5, h6 {
		margin-top: 3rem;
	}

	h1, h2, h3 {
		color: #005A9C;
		background: transparent;
	}

	h1 { font-size: 170%; }
	h2 { font-size: 140%; }
	h3 { font-size: 120%; }
	h4 { font-weight: bold; }
	h5 { font-style: italic; }
	h6 { font-variant: small-caps; }
	dt { font-weight: bold; }

/** Subheadings ***************************************************************/

	h1 + h2,
	#subtitle {
		/* #subtitle is a subtitle in an H2 under the H1 */
		margin-top: 0;
	}
	h2 + h3,
	h3 + h4,
	h4 + h5,
	h5 + h6 {
		margin-top: 1.2em; /* = 1 x line-height */
	}

/** Section divider ***********************************************************/

	:not(.head) > hr {
		font-size: 1.5em;
		text-align: center;
		margin: 1em auto;
		height: auto;
		border: transparent solid 0;
		background: transparent;
	}
	:not(.head) > hr::before {
		content: "\2727\2003\2003\2727\2003\2003\2727";
	}

/******************************************************************************/
/*                            Paragraphs and Lists                            */
/******************************************************************************/

	p {
		margin: 1em 0;
	}

	dd > p:first-child,
	li > p:first-child {
		margin-top: 0;
	}

	ul, ol {
		margin-left: 0;
		padding-left: 2em;
	}

	li {
		margin: 0.25em 0 0.5em;
		padding: 0;
	}

	dl dd {
		margin: 0 0 .5em 2em;
	}

	.head dd + dd { /* compact for header */
		margin-top: -.5em;
	}

	/* Style for algorithms */
	ol.algorithm ol:not(.algorithm),
	.algorithm > ol ol:not(.algorithm) {
	 border-left: 0.5em solid #DEF;
	}

	/* Put nice boxes around each algorithm. */
	[data-algorithm]:not(.heading) {
	  padding: .5em;
	  border: thin solid #ddd; border-radius: .5em;
	  margin: .5em calc(-0.5em - 1px);
	}
	[data-algorithm]:not(.heading) > :first-child {
	  margin-top: 0;
	}
	[data-algorithm]:not(.heading) > :last-child {
	  margin-bottom: 0;
	}

	/* Style for switch/case <dl>s */
	dl.switch > dd > ol.only,
	dl.switch > dd > .only > ol {
	 margin-left: 0;
	}
	dl.switch > dd > ol.algorithm,
	dl.switch > dd > .algorithm > ol {
	 margin-left: -2em;
	}
	dl.switch {
	 padding-left: 2em;
	}
	dl.switch > dt {
	 text-indent: -1.5em;
	 margin-top: 1em;
	}
	dl.switch > dt + dt {
	 margin-top: 0;
	}
	dl.switch > dt::before {
	 content: '\21AA';
	 padding: 0 0.5em 0 0;
	 display: inline-block;
	 width: 1em;
	 text-align: right;
	 line-height: 0.5em;
	}

/** Terminology Markup ********************************************************/


/******************************************************************************/
/*                                 Inline Markup                              */
/******************************************************************************/

/** Terminology Markup ********************************************************/
	dfn   { /* Defining instance */
		font-weight: bolder;
	}
	a > i { /* Instance of term */
		font-style: normal;
	}
	dt dfn code, code.idl {
		font-size: medium;
	}
	dfn var {
		font-style: normal;
	}

/** Change Marking ************************************************************/

	del { color: red;  text-decoration: line-through; }
	ins { color: #080; text-decoration: underline;    }

/** Miscellaneous improvements to inline formatting ***************************/

	sup {
		vertical-align: super;
		font-size: 80%
	}

/******************************************************************************/
/*                                    Code                                    */
/******************************************************************************/

/** General monospace/pre rules ***********************************************/

	pre, code, samp {
		font-family: Menlo, Consolas, "DejaVu Sans Mono", Monaco, monospace;
		font-size: .9em;
		page-break-inside: avoid;
		hyphens: none;
		text-transform: none;
	}
	pre code,
	code code {
		font-size: 100%;
	}

	pre {
		margin-top: 1em;
		margin-bottom: 1em;
		overflow: auto;
	}

/** Inline Code fragments *****************************************************/

  /* Do something nice. */

/******************************************************************************/
/*                                    Links                                   */
/******************************************************************************/

/** General Hyperlinks ********************************************************/

	/* We hyperlink a lot, so make it less intrusive */
	a[href] {
		color: #034575;
		text-decoration: none;
		border-bottom: 1px solid #707070;
		/* Need a bit of extending for it to look okay */
		padding: 0 1px 0;
		margin: 0 -1px 0;
	}
	a:visited {
		border-bottom-color: #BBB;
	}

	/* Use distinguishing colors when user is interacting with the link */
	a[href]:focus,
	a[href]:hover {
		background: #f8f8f8;
		background: rgba(75%, 75%, 75%, .25);
		border-bottom-width: 3px;
		margin-bottom: -2px;
	}
	a[href]:active {
		color: #C00;
		border-color: #C00;
	}

	/* Backout above styling for W3C logo */
	.head .logo,
	.head .logo a {
		border: none;
		text-decoration: none;
		background: transparent;
	}

/******************************************************************************/
/*                                    Images                                  */
/******************************************************************************/

	img {
		border-style: none;
	}

	/* For autogen numbers, add
	   .caption::before, figcaption::before { content: "Figure " counter(figure) ". "; }
	*/

	figure, .figure, .sidefigure {
		page-break-inside: avoid;
		text-align: center;
		margin: 2.5em 0;
	}
	.figure img,    .sidefigure img,    figure img,
	.figure object, .sidefigure object, figure object {
		max-width: 100%;
		margin: auto;
	}
	.figure pre, .sidefigure pre, figure pre {
		text-align: left;
		display: table;
		margin: 1em auto;
	}
	.figure table, figure table {
		margin: auto;
	}
	@media screen and (min-width: 20em) {
		.sidefigure {
			float: right;
			width: 50%;
			margin: 0 0 0.5em 0.5em
		}
	}
	.caption, figcaption, caption {
		font-style: italic;
		font-size: 90%;
	}
	.caption::before, figcaption::before, figcaption > .marker {
		font-weight: bold;
	}
	.caption, figcaption {
		counter-increment: figure;
	}

	/* DL list is indented 2em, but figure inside it is not */
	dd > .figure, dd > figure { margin-left: -2em }

/******************************************************************************/
/*                             Colored Boxes                                  */
/******************************************************************************/

	.issue, .note, .example, .assertion, .advisement, blockquote {
		padding: .5em;
		border: .5em;
		border-left-style: solid;
		page-break-inside: avoid;
	}
	span.issue, span.note {
		padding: .1em .5em .15em;
		border-right-style: solid;
	}

	.issue,
	.note,
	.example,
	.advisement,
	.assertion,
	blockquote {
		margin: 1em auto;
	}
	.note  > p:first-child,
	.issue > p:first-child,
	blockquote > :first-child {
		margin-top: 0;
	}
	blockquote > :last-child {
		margin-bottom: 0;
	}

/** Blockquotes ***************************************************************/

	blockquote {
		border-color: silver;
	}

/** Open issue ****************************************************************/

	.issue {
		border-color: #E05252;
		background: #FBE9E9;
		counter-increment: issue;
		overflow: auto;
	}
	.issue::before, .issue > .marker {
		text-transform: uppercase;
		color: #AE1E1E;
		padding-right: 1em;
		text-transform: uppercase;
	}
	/* Add .issue::before { content: "Issue " counter(issue) " "; } for autogen numbers,
	   or use class="marker" to mark up the issue number in source. */

/** Example *******************************************************************/

	.example {
		border-color: #E0CB52;
		background: #FCFAEE;
		counter-increment: example;
		overflow: auto;
		clear: both;
	}
	.example::before, .example > .marker {
		text-transform: uppercase;
		color: #827017;
		min-width: 7.5em;
		display: block;
	}
	/* Add .example::before { content: "Example " counter(example) " "; } for autogen numbers,
	   or use class="marker" to mark up the example number in source. */

/** Non-normative Note ********************************************************/

	.note {
		border-color: #52E052;
		background: #E9FBE9;
		overflow: auto;
	}

	.note::before, .note > .marker,
	details.note > summary::before,
	details.note > summary > .marker {
		text-transform: uppercase;
		display: block;
		color: hsl(120, 70%, 30%);
	}
	/* Add .note::before { content: "Note"; } for autogen label,
	   or use class="marker" to mark up the label in source. */

	details.note > summary {
		display: block;
		color: hsl(120, 70%, 30%);
	}
	details.note[open] > summary {
		border-bottom: 1px silver solid;
	}

/** Assertion Box *************************************************************/
	/*  for assertions in algorithms */

	.assertion {
		border-color: #AAA;
		background: #EEE;
	}

/** Advisement Box ************************************************************/
	/*  for attention-grabbing normative statements */

	.advisement {
		border-color: orange;
		border-style: none solid;
		background: #FFEECC;
	}
	strong.advisement {
		display: block;
		text-align: center;
	}
	.advisement > .marker {
		color: #B35F00;
	}

/** Spec Obsoletion Notice ****************************************************/
	/* obnoxious obsoletion notice for older/abandoned specs. */

	details {
		display: block;
	}
	summary {
		font-weight: bolder;
	}

	.annoying-warning:not(details),
	details.annoying-warning:not([open]) > summary,
	details.annoying-warning[open] {
		background: #fdd;
		color: red;
		font-weight: bold;
		padding: .75em 1em;
		border: thick red;
		border-style: solid;
		border-radius: 1em;
	}
	.annoying-warning :last-child {
		margin-bottom: 0;
	}

@media not print {
	details.annoying-warning[open] {
		position: fixed;
		left: 1em;
		right: 1em;
		bottom: 1em;
		z-index: 1000;
	}
}

	details.annoying-warning:not([open]) > summary {
		text-align: center;
	}

/** Entity Definition Boxes ***************************************************/

	.def {
		padding: .5em 1em;
		background: #DEF;
		margin: 1.2em 0;
		border-left: 0.5em solid #8CCBF2;
	}

/******************************************************************************/
/*                                    Tables                                  */
/******************************************************************************/

	th, td {
		text-align: left;
		text-align: start;
	}

/** Property/Descriptor Definition Tables *************************************/

	table.def {
		/* inherits .def box styling, see above */
		width: 100%;
		border-spacing: 0;
	}

	table.def td,
	table.def th {
		padding: 0.5em;
		vertical-align: baseline;
		border-bottom: 1px solid #bbd7e9;
	}

	table.def > tbody > tr:last-child th,
	table.def > tbody > tr:last-child td {
		border-bottom: 0;
	}

	table.def th {
		font-style: italic;
		font-weight: normal;
		padding-left: 1em;
		width: 3em;
	}

	/* For when values are extra-complex and need formatting for readability */
	table td.pre {
		white-space: pre-wrap;
	}

	/* A footnote at the bottom of a def table */
	table.def           td.footnote {
		padding-top: 0.6em;
	}
	table.def           td.footnote::before {
		content: " ";
		display: block;
		height: 0.6em;
		width: 4em;
		border-top: thin solid;
	}

/** Data tables (and properly marked-up index tables) *************************/
	/*
		 <table class="data"> highlights structural relationships in a table
		 when correct markup is used (e.g. thead/tbody, th vs. td, scope attribute)

		 Use class="complex data" for particularly complicated tables --
		 (This will draw more lines: busier, but clearer.)

		 Use class="long" on table cells with paragraph-like contents
		 (This will adjust text alignment accordingly.)
		 Alternately use class="longlastcol" on tables, to have the last column assume "long".
	*/

	table {
		word-wrap: normal;
		overflow-wrap: normal;
		hyphens: manual;
	}

	table.data,
	table.index {
		margin: 1em auto;
		border-collapse: collapse;
		border: hidden;
		width: 100%;
	}
	table.data caption,
	table.index caption {
		max-width: 50em;
		margin: 0 auto 1em;
	}

	table.data td,  table.data th,
	table.index td, table.index th {
		padding: 0.5em 1em;
		border-width: 1px;
		border-color: silver;
		border-top-style: solid;
	}

	table.data thead td:empty {
		padding: 0;
		border: 0;
	}

	table.data  thead,
	table.index thead,
	table.data  tbody,
	table.index tbody {
		border-bottom: 2px solid;
	}

	table.data colgroup,
	table.index colgroup {
		border-left: 2px solid;
	}

	table.data  tbody th:first-child,
	table.index tbody th:first-child  {
		border-right: 2px solid;
		border-top: 1px solid silver;
		padding-right: 1em;
	}

	table.data th[colspan],
	table.data td[colspan] {
		text-align: center;
	}

	table.complex.data th,
	table.complex.data td {
		border: 1px solid silver;
		text-align: center;
	}

	table.data.longlastcol td:last-child,
	table.data td.long {
	 vertical-align: baseline;
	 text-align: left;
	}

	table.data img {
		vertical-align: middle;
	}


/*
Alternate table alignment rules

	table.data,
	table.index {
		text-align: center;
	}

	table.data  thead th[scope="row"],
	table.index thead th[scope="row"] {
		text-align: right;
	}

	table.data  tbody th:first-child,
	table.index tbody th:first-child  {
		text-align: right;
	}

Possible extra rowspan handling

	table.data  tbody th[rowspan]:not([rowspan='1']),
	table.index tbody th[rowspan]:not([rowspan='1']),
	table.data  tbody td[rowspan]:not([rowspan='1']),
	table.index tbody td[rowspan]:not([rowspan='1']) {
		border-left: 1px solid silver;
	}

	table.data  tbody th[rowspan]:first-child,
	table.index tbody th[rowspan]:first-child,
	table.data  tbody td[rowspan]:first-child,
	table.index tbody td[rowspan]:first-child{
		border-left: 0;
		border-right: 1px solid silver;
	}
*/

/******************************************************************************/
/*                                  Indices                                   */
/******************************************************************************/


/** Table of Contents *********************************************************/

	.toc a {
		/* More spacing; use padding to make it part of the click target. */
		padding-top: 0.1rem;
		/* Larger, more consistently-sized click target */
		display: block;
		/* Reverse color scheme */
		color: black;
		border-color: #3980B5;
		border-bottom-width: 3px !important;
		margin-bottom: 0px !important;
	}
	.toc a:visited {
		border-color: #054572;
	}
	.toc a:not(:focus):not(:hover) {
		/* Allow colors to cascade through from link styling */
		border-bottom-color: transparent;
	}

	.toc, .toc ol, .toc ul, .toc li {
		list-style: none; /* Numbers must be inlined into source */
		/* because generated content isn't search/selectable and markers can't do multilevel yet */
		margin:  0;
		padding: 0;
		line-height: 1.1rem; /* consistent spacing */
	}

	/* ToC not indented until third level, but font style & margins show hierarchy */
	.toc > li             { font-weight: bold;   }
	.toc > li li          { font-weight: normal; }
	.toc > li li li       { font-size:   95%;    }
	.toc > li li li li    { font-size:   90%;    }
	.toc > li li li li li { font-size:   85%;    }

	.toc > li             { margin: 1.5rem 0;    }
	.toc > li li          { margin: 0.3rem 0;    }
	.toc > li li li       { margin-left: 2rem;   }

	/* Section numbers in a column of their own */
	.toc .secno {
		float: left;
		width: 4rem;
		white-space: nowrap;
	}
	.toc > li li li li .secno {
		font-size: 85%;
	}
	.toc > li li li li li .secno {
		font-size: 100%;
	}

	:not(li) > .toc              { margin-left:  5rem; }
	.toc .secno                  { margin-left: -5rem; }
	.toc > li li li .secno       { margin-left: -7rem; }
	.toc > li li li li .secno    { margin-left: -9rem; }
	.toc > li li li li li .secno { margin-left: -11rem; }

	/* Tighten up indentation in narrow ToCs */
	@media (max-width: 30em) {
		:not(li) > .toc              { margin-left:  4rem; }
		.toc .secno                  { margin-left: -4rem; }
		.toc > li li li              { margin-left:  1rem; }
		.toc > li li li .secno       { margin-left: -5rem; }
		.toc > li li li li .secno    { margin-left: -6rem; }
		.toc > li li li li li .secno { margin-left: -7rem; }
	}
	@media screen and (min-width: 78em) {
		body:not(.toc-inline) :not(li) > .toc              { margin-left:  4rem; }
		body:not(.toc-inline) .toc .secno                  { margin-left: -4rem; }
		body:not(.toc-inline) .toc > li li li              { margin-left:  1rem; }
		body:not(.toc-inline) .toc > li li li .secno       { margin-left: -5rem; }
		body:not(.toc-inline) .toc > li li li li .secno    { margin-left: -6rem; }
		body:not(.toc-inline) .toc > li li li li li .secno { margin-left: -7rem; }
	}
	body.toc-sidebar #toc :not(li) > .toc              { margin-left:  4rem; }
	body.toc-sidebar #toc .toc .secno                  { margin-left: -4rem; }
	body.toc-sidebar #toc .toc > li li li              { margin-left:  1rem; }
	body.toc-sidebar #toc .toc > li li li .secno       { margin-left: -5rem; }
	body.toc-sidebar #toc .toc > li li li li .secno    { margin-left: -6rem; }
	body.toc-sidebar #toc .toc > li li li li li .secno { margin-left: -7rem; }

	.toc li {
		clear: both;
	}


/** Index *********************************************************************/

	/* Index Lists: Layout */
	ul.index       { margin-left: 0; columns: 15em; text-indent: 1em hanging; }
	ul.index li    { margin-left: 0; list-style: none; break-inside: avoid; }
	ul.index li li { margin-left: 1em }
	ul.index dl    { margin-top: 0; }
	ul.index dt    { margin: .2em 0 .2em 20px;}
	ul.index dd    { margin: .2em 0 .2em 40px;}
	/* Index Lists: Typography */
	ul.index ul,
	ul.index dl { font-size: smaller; }
	@media not print {
		ul.index li span {
			white-space: nowrap;
			color: transparent; }
		ul.index li a:hover + span,
		ul.index li a:focus + span {
			color: #707070;
		}
	}

/** Index Tables *****************************************************/
	/* See also the data table styling section, which this effectively subclasses */

	table.index {
		font-size: small;
		border-collapse: collapse;
		border-spacing: 0;
		text-align: left;
		margin: 1em 0;
	}

	table.index td,
	table.index th {
		padding: 0.4em;
	}

	table.index tr:hover td:not([rowspan]),
	table.index tr:hover th:not([rowspan]) {
		background: #f7f8f9;
	}

	/* The link in the first column in the property table (formerly a TD) */
	table.index th:first-child a {
		font-weight: bold;
	}

/******************************************************************************/
/*                                    Print                                   */
/******************************************************************************/

	@media print {
		/* Pages have their own margins. */
		html {
			margin: 0;
		}
		/* Serif for print. */
		body {
			font-family: serif;
		}
	}
	@page {
		margin: 1.5cm 1.1cm;
	}

/******************************************************************************/
/*                                    Legacy                                  */
/******************************************************************************/

	/* This rule is inherited from past style sheets. No idea what it's for. */
	.hide { display: none }



/******************************************************************************/
/*                             Overflow Control                               */
/******************************************************************************/

	.figure .caption, .sidefigure .caption, figcaption {
		/* in case figure is overlarge, limit caption to 50em */
		max-width: 50rem;
		margin-left: auto;
		margin-right: auto;
	}
	.overlarge > table {
		/* limit preferred width of table */
		max-width: 50em;
		margin-left: auto;
		margin-right: auto;
	}

	@media (min-width: 55em) {
		.overlarge {
			margin-left: calc(13px + 26.5rem - 50vw);
			margin-right: calc(13px + 26.5rem - 50vw);
			max-width: none;
		}
	}
	@media screen and (min-width: 78em) {
		body:not(.toc-inline) .overlarge {
			/* 30.5em body padding 50em content area */
			margin-left: calc(40em - 50vw) !important;
			margin-right: calc(40em - 50vw) !important;
		}
	}
	@media screen and (min-width: 90em) {
		body:not(.toc-inline) .overlarge {
			/* 4em html margin 30.5em body padding 50em content area */
			margin-left: 0 !important;
			margin-right: calc(84.5em - 100vw) !important;
		}
	}

	@media not print {
		.overlarge {
			overflow-x: auto;
			/* See Lea Verou's explanation background-attachment:
			 * http://lea.verou.me/2012/04/background-attachment-local/
			 *
			background: top left  / 4em 100% linear-gradient(to right,  #ffffff, rgba(255, 255, 255, 0)) local,
			            top right / 4em 100% linear-gradient(to left, #ffffff, rgba(255, 255, 255, 0)) local,
			            top left  / 1em 100% linear-gradient(to right,  #c3c3c5, rgba(195, 195, 197, 0)) scroll,
			            top right / 1em 100% linear-gradient(to left, #c3c3c5, rgba(195, 195, 197, 0)) scroll,
			            white;
			background-repeat: no-repeat;
			*/
		}
	}
</style>
  <meta content="Bikeshed version 07825b34de4f0ee79f05bebadad39f81bb9aaaf2" name="generator">
  <link href="https://wicg.github.io/reporting/" rel="canonical">
<style>/* style-md-lists */

            /* This is a weird hack for me not yet following the commonmark spec
               regarding paragraph and lists. */
            [data-md] > :first-child {
                margin-top: 0;
            }
            [data-md] > :last-child {
                margin-bottom: 0;
            }</style>
<style>/* style-selflinks */

            .heading, .issue, .note, .example, li, dt {
                position: relative;
            }
            a.self-link {
                position: absolute;
                top: 0;
                left: calc(-1 * (3.5rem - 26px));
                width: calc(3.5rem - 26px);
                height: 2em;
                text-align: center;
                border: none;
                transition: opacity .2s;
                opacity: .5;
            }
            a.self-link:hover {
                opacity: 1;
            }
            .heading > a.self-link {
                font-size: 83%;
            }
            li > a.self-link {
                left: calc(-1 * (3.5rem - 26px) - 2em);
            }
            dfn > a.self-link {
                top: auto;
                left: auto;
                opacity: 0;
                width: 1.5em;
                height: 1.5em;
                background: gray;
                color: white;
                font-style: normal;
                transition: opacity .2s, background-color .2s, color .2s;
            }
            dfn:hover > a.self-link {
                opacity: 1;
            }
            dfn > a.self-link:hover {
                color: black;
            }

            a.self-link::before            { content: "Â¶"; }
            .heading > a.self-link::before { content: "Â§"; }
            dfn > a.self-link::before      { content: "#"; }</style>
<style>/* style-counters */

            body {
                counter-reset: example figure issue;
            }
            .issue {
                counter-increment: issue;
            }
            .issue:not(.no-marker)::before {
                content: "Issue " counter(issue);
            }

            .example {
                counter-increment: example;
            }
            .example:not(.no-marker)::before {
                content: "Example " counter(example);
            }
            .invalid.example:not(.no-marker)::before,
            .illegal.example:not(.no-marker)::before {
                content: "Invalid Example" counter(example);
            }

            figcaption {
                counter-increment: figure;
            }
            figcaption:not(.no-marker)::before {
                content: "Figure " counter(figure) " ";
            }</style>
<style>/* style-autolinks */

            .css.css, .property.property, .descriptor.descriptor {
                color: #005a9c;
                font-size: inherit;
                font-family: inherit;
            }
            .css::before, .property::before, .descriptor::before {
                content: "â";
            }
            .css::after, .property::after, .descriptor::after {
                content: "â";
            }
            .property, .descriptor {
                /* Don't wrap property and descriptor names */
                white-space: nowrap;
            }
            .type { /* CSS value <type> */
                font-style: italic;
            }
            pre .property::before, pre .property::after {
                content: "";
            }
            [data-link-type="property"]::before,
            [data-link-type="propdesc"]::before,
            [data-link-type="descriptor"]::before,
            [data-link-type="value"]::before,
            [data-link-type="function"]::before,
            [data-link-type="at-rule"]::before,
            [data-link-type="selector"]::before,
            [data-link-type="maybe"]::before {
                content: "â";
            }
            [data-link-type="property"]::after,
            [data-link-type="propdesc"]::after,
            [data-link-type="descriptor"]::after,
            [data-link-type="value"]::after,
            [data-link-type="function"]::after,
            [data-link-type="at-rule"]::after,
            [data-link-type="selector"]::after,
            [data-link-type="maybe"]::after {
                content: "â";
            }

            [data-link-type].production::before,
            [data-link-type].production::after,
            .prod [data-link-type]::before,
            .prod [data-link-type]::after {
                content: "";
            }

            [data-link-type=element],
            [data-link-type=element-attr] {
                font-family: Menlo, Consolas, "DejaVu Sans Mono", monospace;
                font-size: .9em;
            }
            [data-link-type=element]::before { content: "<" }
            [data-link-type=element]::after  { content: ">" }

            [data-link-type=biblio] {
                white-space: pre;
            }</style>
<style>/* style-dfn-panel */

        .dfn-panel {
            position: absolute;
            z-index: 35;
            height: auto;
            width: -webkit-fit-content;
            width: fit-content;
            max-width: 300px;
            max-height: 500px;
            overflow: auto;
            padding: 0.5em 0.75em;
            font: small Helvetica Neue, sans-serif, Droid Sans Fallback;
            background: #DDDDDD;
            color: black;
            border: outset 0.2em;
        }
        .dfn-panel:not(.on) { display: none; }
        .dfn-panel * { margin: 0; padding: 0; text-indent: 0; }
        .dfn-panel > b { display: block; }
        .dfn-panel a { color: black; }
        .dfn-panel a:not(:hover) { text-decoration: none !important; border-bottom: none !important; }
        .dfn-panel > b + b { margin-top: 0.25em; }
        .dfn-panel ul { padding: 0; }
        .dfn-panel li { list-style: inside; }
        .dfn-panel.activated {
            display: inline-block;
            position: fixed;
            left: .5em;
            bottom: 2em;
            margin: 0 auto;
            max-width: calc(100vw - 1.5em - .4em - .5em);
            max-height: 30vh;
        }

        .dfn-paneled { cursor: pointer; }
        </style>
<style>/* style-syntax-highlighting */
pre.idl.highlight { color: #708090; }
.highlight:not(.idl) { background: hsl(24, 20%, 95%); }
code.highlight { padding: .1em; border-radius: .3em; }
pre.highlight, pre > code.highlight { display: block; padding: 1em; margin: .5em 0; overflow: auto; border-radius: 0; }
.highlight .c { color: #708090 } /* Comment */
.highlight .k { color: #990055 } /* Keyword */
.highlight .l { color: #000000 } /* Literal */
.highlight .n { color: #0077aa } /* Name */
.highlight .o { color: #999999 } /* Operator */
.highlight .p { color: #999999 } /* Punctuation */
.highlight .cm { color: #708090 } /* Comment.Multiline */
.highlight .cp { color: #708090 } /* Comment.Preproc */
.highlight .c1 { color: #708090 } /* Comment.Single */
.highlight .cs { color: #708090 } /* Comment.Special */
.highlight .kc { color: #990055 } /* Keyword.Constant */
.highlight .kd { color: #990055 } /* Keyword.Declaration */
.highlight .kn { color: #990055 } /* Keyword.Namespace */
.highlight .kp { color: #990055 } /* Keyword.Pseudo */
.highlight .kr { color: #990055 } /* Keyword.Reserved */
.highlight .kt { color: #990055 } /* Keyword.Type */
.highlight .ld { color: #000000 } /* Literal.Date */
.highlight .m { color: #000000 } /* Literal.Number */
.highlight .s { color: #a67f59 } /* Literal.String */
.highlight .na { color: #0077aa } /* Name.Attribute */
.highlight .nc { color: #0077aa } /* Name.Class */
.highlight .no { color: #0077aa } /* Name.Constant */
.highlight .nd { color: #0077aa } /* Name.Decorator */
.highlight .ni { color: #0077aa } /* Name.Entity */
.highlight .ne { color: #0077aa } /* Name.Exception */
.highlight .nf { color: #0077aa } /* Name.Function */
.highlight .nl { color: #0077aa } /* Name.Label */
.highlight .nn { color: #0077aa } /* Name.Namespace */
.highlight .py { color: #0077aa } /* Name.Property */
.highlight .nt { color: #669900 } /* Name.Tag */
.highlight .nv { color: #222222 } /* Name.Variable */
.highlight .ow { color: #999999 } /* Operator.Word */
.highlight .mb { color: #000000 } /* Literal.Number.Bin */
.highlight .mf { color: #000000 } /* Literal.Number.Float */
.highlight .mh { color: #000000 } /* Literal.Number.Hex */
.highlight .mi { color: #000000 } /* Literal.Number.Integer */
.highlight .mo { color: #000000 } /* Literal.Number.Oct */
.highlight .sb { color: #a67f59 } /* Literal.String.Backtick */
.highlight .sc { color: #a67f59 } /* Literal.String.Char */
.highlight .sd { color: #a67f59 } /* Literal.String.Doc */
.highlight .s2 { color: #a67f59 } /* Literal.String.Double */
.highlight .se { color: #a67f59 } /* Literal.String.Escape */
.highlight .sh { color: #a67f59 } /* Literal.String.Heredoc */
.highlight .si { color: #a67f59 } /* Literal.String.Interpol */
.highlight .sx { color: #a67f59 } /* Literal.String.Other */
.highlight .sr { color: #a67f59 } /* Literal.String.Regex */
.highlight .s1 { color: #a67f59 } /* Literal.String.Single */
.highlight .ss { color: #a67f59 } /* Literal.String.Symbol */
.highlight .vc { color: #0077aa } /* Name.Variable.Class */
.highlight .vg { color: #0077aa } /* Name.Variable.Global */
.highlight .vi { color: #0077aa } /* Name.Variable.Instance */
.highlight .il { color: #000000 } /* Literal.Number.Integer.Long */
</style>
 <body class="h-entry">
  <div class="head">
   <p data-fill-with="logo"></p>
   <h1>Reporting API</h1>
   <h2 class="no-num no-toc no-ref heading settled" id="subtitle"><span class="content">Draft Community Group Report, <time class="dt-updated" datetime="2017-09-01">1 September 2017</time></span></h2>
   <div data-fill-with="spec-metadata">
    <dl>
     <dt>This version:
     <dd><a class="u-url" href="https://wicg.github.io/reporting/">https://wicg.github.io/reporting/</a>
     <dt>Version History:
     <dd><a href="https://github.com/wicg/reporting/commits/master/index.src.html">https://github.com/wicg/reporting/commits/master/index.src.html</a>
     <dt class="editor">Editors:
     <dd class="editor p-author h-card vcard" data-editor-id="56102"><a class="p-name fn u-email email" href="mailto:igrigorik@google.comm">Ilya Grigorik</a> (<span class="p-org org">Google Inc.</span>)
     <dd class="editor p-author h-card vcard" data-editor-id="56384"><a class="p-name fn u-email email" href="mailto:mkwst@google.com">Mike West</a> (<span class="p-org org">Google Inc.</span>)
     <dt>Participate:
     <dd><span><a href="https://github.com/wicg/reporting/issues/new">File an issue</a> (<a href="https://github.com/wicg/reporting/issues">open issues</a>)</span>
    </dl>
   </div>
   <div data-fill-with="warning"></div>
   <p class="copyright" data-fill-with="copyright"><a href="http://www.w3.org/Consortium/Legal/ipr-notice#Copyright">Copyright</a> Â© 2017 the Contributors to the Reporting API Specification, published by the <a href="https://www.w3.org/community/wicg/">Web Platform Incubator Community Group</a> under the <a href="https://www.w3.org/community/about/agreements/cla/">W3C Community Contributor License Agreement (CLA)</a>.
A human-readable <a href="http://www.w3.org/community/about/agreements/cla-deed/">summary</a> is available. </p>
   <hr title="Separator for header">
  </div>
  <div class="p-summary" data-fill-with="abstract">
   <h2 class="no-num no-toc no-ref heading settled" id="abstract"><span class="content">Abstract</span></h2>
   <p>This document defines a generic reporting framework which allows web

developers to associate a set of named reporting endpoints with an origin.
Various platform features (like Content Security Policy, Network Error
Reporting, and others) will use these endpoints to deliver feature-specific
reports in a consistent manner.</p>
  </div>
  <div data-fill-with="at-risk"></div>
  <h2 class="no-num no-toc no-ref heading settled" id="status"><span class="content">Status of this document</span></h2>
  <div data-fill-with="status">
   <p> This specification was published by the <a href="https://www.w3.org/community/wicg/">Web Platform Incubator Community Group</a>.
  It is not a W3C Standard nor is it on the W3C Standards Track.

  Please note that under the <a href="https://www.w3.org/community/about/agreements/cla/">W3C Community Contributor License Agreement (CLA)</a> there is a limited opt-out and other conditions apply.

  Learn more about <a href="http://www.w3.org/community/">W3C Community and Business Groups</a>. </p>
   <p></p>
  </div>
  <div data-fill-with="at-risk"></div>
  <nav data-fill-with="table-of-contents" id="toc">
   <h2 class="no-num no-toc no-ref" id="contents">Table of Contents</h2>
   <ol class="toc" role="directory">
    <li>
     <a href="#intro"><span class="secno">1</span> <span class="content">Introduction</span></a>
     <ol class="toc">
      <li><a href="#guarantees"><span class="secno">1.1</span> <span class="content">Guarantees</span></a>
      <li><a href="#examples"><span class="secno">1.2</span> <span class="content">Examples</span></a>
     </ol>
    <li>
     <a href="#concept"><span class="secno">2</span> <span class="content">Concepts</span></a>
     <ol class="toc">
      <li><a href="#concept-endpoints"><span class="secno">2.1</span> <span class="content">Endpoints</span></a>
      <li><a href="#concept-client"><span class="secno">2.2</span> <span class="content">Clients</span></a>
      <li><a href="#concept-reports"><span class="secno">2.3</span> <span class="content">Reports</span></a>
      <li><a href="#concept-storage"><span class="secno">2.4</span> <span class="content">Storage</span></a>
     </ol>
    <li>
     <a href="#endpoint-delivery"><span class="secno">3</span> <span class="content">Endpoint Delivery</span></a>
     <ol class="toc">
      <li>
       <a href="#header"><span class="secno">3.1</span> <span class="content">The <code>Report-To</code> HTTP Response Header Field</span></a>
       <ol class="toc">
        <li><a href="#url-member"><span class="secno">3.1.1</span> <span class="content">The <code>url</code> member</span></a>
        <li><a href="#id-member"><span class="secno">3.1.2</span> <span class="content">The <code>group</code> member</span></a>
        <li><a href="#includesubdomains-member"><span class="secno">3.1.3</span> <span class="content">The <code>includeSubdomains</code> member</span></a>
        <li><a href="#max-age-member"><span class="secno">3.1.4</span> <span class="content">The <code>max-age</code> member</span></a>
       </ol>
      <li><a href="#process-header"><span class="secno">3.2</span> <span class="content"> Process reporting endpoints for <var>response</var> to <var>request</var> </span></a>
      <li><a href="#parse-header"><span class="secno">3.3</span> <span class="content"> Parse reporting endpoint tuples from <var>value</var> </span></a>
     </ol>
    <li>
     <a href="#report-delivery"><span class="secno">4</span> <span class="content">Report Delivery</span></a>
     <ol class="toc">
      <li><a href="#queue-report"><span class="secno">4.1</span> <span class="content"> Queue <var>data</var> as <var>type</var> for <var>endpoint group</var> on <var>settings</var> </span></a>
      <li><a href="#does-endpoint-match-report"><span class="secno">4.2</span> <span class="content"> Does <var>endpoint</var> match <var>report</var>? </span></a>
      <li><a href="#send-reports"><span class="secno">4.3</span> <span class="content"> Send reports </span></a>
      <li><a href="#try-delivery"><span class="secno">4.4</span> <span class="content"> Attempt to deliver <var>reports</var> to <var>endpoint</var> </span></a>
     </ol>
    <li>
     <a href="#observers"><span class="secno">5</span> <span class="content">Reporting Observers</span></a>
     <ol class="toc">
      <li><a href="#interface-reporting-observer"><span class="secno">5.1</span> <span class="content">Interface <code class="idl"><span>ReportingObserver</span></code></span></a>
      <li><a href="#notify-observers"><span class="secno">5.2</span> <span class="content"> Notify reporting observers on <var>settings</var> with <var>report</var>. </span></a>
      <li><a href="#invoke-observers"><span class="secno">5.3</span> <span class="content"> Invoke observers with <var>notify list</var>. </span></a>
     </ol>
    <li>
     <a href="#implementation"><span class="secno">6</span> <span class="content">Implementation Considerations</span></a>
     <ol class="toc">
      <li><a href="#delivery"><span class="secno">6.1</span> <span class="content">Delivery</span></a>
      <li><a href="#gc"><span class="secno">6.2</span> <span class="content">Garbage Collection</span></a>
     </ol>
    <li><a href="#sample-reports"><span class="secno">7</span> <span class="content">Sample Reports</span></a>
    <li>
     <a href="#security"><span class="secno">8</span> <span class="content">Security Considerations</span></a>
     <ol class="toc">
      <li><a href="#capability-urls"><span class="secno">8.1</span> <span class="content">Capability URLs</span></a>
     </ol>
    <li>
     <a href="#privacy"><span class="secno">9</span> <span class="content">Privacy Considerations</span></a>
     <ol class="toc">
      <li><a href="#network-leakage"><span class="secno">9.1</span> <span class="content">Network Leakage</span></a>
      <li><a href="#fingerprinting-clock-skew"><span class="secno">9.2</span> <span class="content">Clock Skew</span></a>
      <li><a href="#correlation"><span class="secno">9.3</span> <span class="content">Cross-origin correlation</span></a>
      <li><a href="#subdomains"><span class="secno">9.4</span> <span class="content">Subdomains</span></a>
      <li><a href="#clear-cache"><span class="secno">9.5</span> <span class="content">Clearing the reporting cache</span></a>
      <li><a href="#disable"><span class="secno">9.6</span> <span class="content">Disabling Reporting</span></a>
     </ol>
    <li>
     <a href="#iana-considerations"><span class="secno">10</span> <span class="content">IANA Considerations</span></a>
     <ol class="toc">
      <li><a href="#iana-report-to"><span class="secno">10.1</span> <span class="content"> Report-To </span></a>
     </ol>
    <li>
     <a href="#index"><span class="secno"></span> <span class="content">Index</span></a>
     <ol class="toc">
      <li><a href="#index-defined-here"><span class="secno"></span> <span class="content">Terms defined by this specification</span></a>
      <li><a href="#index-defined-elsewhere"><span class="secno"></span> <span class="content">Terms defined by reference</span></a>
     </ol>
    <li>
     <a href="#references"><span class="secno"></span> <span class="content">References</span></a>
     <ol class="toc">
      <li><a href="#normative"><span class="secno"></span> <span class="content">Normative References</span></a>
      <li><a href="#informative"><span class="secno"></span> <span class="content">Informative References</span></a>
     </ol>
    <li><a href="#idl-index"><span class="secno"></span> <span class="content">IDL Index</span></a>
    <li><a href="#issues-index"><span class="secno"></span> <span class="content">Issues Index</span></a>
   </ol>
  </nav>
  <main>
   <section>
    <h2 class="heading settled" data-level="1" id="intro"><span class="secno">1. </span><span class="content">Introduction</span><a class="self-link" href="#intro"></a></h2>
    <p>[INTRODUCTION GOES HERE]</p>
    <h3 class="heading settled" data-level="1.1" id="guarantees"><span class="secno">1.1. </span><span class="content">Guarantees</span><a class="self-link" href="#guarantees"></a></h3>
    <p>This specification aims to provide a best-effort report delivery system that
  executes out-of-band with website activity. The user agent will be able to do
  a better job prioritizing and scheduling delivery of reports, as it has an
  overview of cross-origin activity that individual websites do not, and can
  deliver reports based on error conditions that would prevent a website from
  loading in the first place.</p>
    <p>The delivery is not, however, guaranteed in a strict sense. We spell out a
  reasonable set of retry rules in the algorithms below, but itâs quite possible
  for a report to be dropped on the floor if things go badly.</p>
    <p>Reporting can generate a good deal of traffic, so we allow developers to set
  up groups of <a data-link-type="dfn" href="#endpoint" id="ref-for-endpoint">endpoints</a> in order to distribute load. Each of these
  endpoints will receive a subset of the generated reports which target that
  group. The user agent will do its best to deliver a particular report to <strong>at most one</strong> endpoint in a group. That is, reports will not
  fan-out to all the endpoints in a group, but the user agent will attempt
  delivery to one endpoint, and fallback to another upon failure.</p>
    <h3 class="heading settled" data-level="1.2" id="examples"><span class="secno">1.2. </span><span class="content">Examples</span><a class="self-link" href="#examples"></a></h3>
    <div class="example" id="example-c76a801d">
     <a class="self-link" href="#example-c76a801d"></a> MegaCorp Inc. wants to collect Content Security Policy and Key Pinning
    violation reports. It can do so by delivering the following header to
    define a set of reporting endpoints named "<code>endpoint-1</code>": 
<pre><a data-link-type="dfn" href="#report-to" id="ref-for-report-to">Report-To</a>: { "<a data-link-type="dfn" href="#reportto-url" id="ref-for-reportto-url">url</a>": "https://example.com/reports",
             "<a data-link-type="dfn" href="#reportto-group" id="ref-for-reportto-group">group</a>": "endpoint-1",
             "<a data-link-type="dfn" href="#reportto-max-age" id="ref-for-reportto-max-age">max-age</a>": 10886400 },
           { "<a data-link-type="dfn" href="#reportto-url" id="ref-for-reportto-urlâ ">url</a>": "https://backup.com/reports",
             "<a data-link-type="dfn" href="#reportto-group" id="ref-for-reportto-groupâ ">group</a>": "endpoint-1",
             "<a data-link-type="dfn" href="#reportto-max-age" id="ref-for-reportto-max-ageâ ">max-age</a>": 10886400 }
</pre>
     <p>And the following headers, which direct CSP and HPKP reports to that group:</p>
<pre><a data-link-type="dfn" href="https://w3c.github.io/webappsec-csp/#content-security-policy" id="ref-for-content-security-policy">Content-Security-Policy</a>: ...; <a data-link-type="dfn" href="https://w3c.github.io/webappsec-csp/#directives-reporting" id="ref-for-directives-reporting">report-to</a>=endpoint-1
<a data-link-type="dfn" href="https://tools.ietf.org/html/rfc7469#section-2.1" id="ref-for-section-2.1">Public-Key-Pins</a>: ...; report-to=endpoint-1
</pre>
    </div>
    <div class="example" id="example-6f9d351c">
     <a class="self-link" href="#example-6f9d351c"></a> After processing reports for a little while, MegaCorp Inc. decides to split
    the processing of these two types of reports out into two distinct endpoints
    in order to make the processing scripts simpler. It can do so by delivering
    the following header to define two reporting endpoints: 
<pre><a data-link-type="dfn" href="#report-to" id="ref-for-report-toâ ">Report-To</a>: { "<a data-link-type="dfn" href="#reportto-url" id="ref-for-reportto-urlâ¡">url</a>": "https://example.com/csp-reports",
             "<a data-link-type="dfn" href="#reportto-group" id="ref-for-reportto-groupâ¡">group</a>": "csp-endpoint",
             "<a data-link-type="dfn" href="#reportto-max-age" id="ref-for-reportto-max-ageâ¡">max-age</a>": 10886400 },
           { "<a data-link-type="dfn" href="#reportto-url" id="ref-for-reportto-urlâ¢">url</a>": "https://example.com/hpkp-reports",
             "<a data-link-type="dfn" href="#reportto-group" id="ref-for-reportto-groupâ¢">group</a>": "hpkp-endpoint",
             "<a data-link-type="dfn" href="#reportto-max-age" id="ref-for-reportto-max-ageâ¢">max-age</a>": 10886400 }
</pre>
     <p>And the following headers, which direct CSP and HPKP reports to those named
    endpoint:</p>
<pre><a data-link-type="dfn" href="https://w3c.github.io/webappsec-csp/#content-security-policy" id="ref-for-content-security-policyâ ">Content-Security-Policy</a>: ...; <a data-link-type="dfn" href="https://w3c.github.io/webappsec-csp/#directives-reporting" id="ref-for-directives-reportingâ ">report-to</a>=csp-endpoint
<a data-link-type="dfn" href="https://tools.ietf.org/html/rfc7469#section-2.1" id="ref-for-section-2.1â ">Public-Key-Pins</a>: ...; report-to=hpkp-endpoint
</pre>
    </div>
   </section>
   <section>
    <h2 class="heading settled" data-level="2" id="concept"><span class="secno">2. </span><span class="content">Concepts</span><a class="self-link" href="#concept"></a></h2>
    <h3 class="heading settled" data-level="2.1" id="concept-endpoints"><span class="secno">2.1. </span><span class="content">Endpoints</span><a class="self-link" href="#concept-endpoints"></a></h3>
    <p>An <dfn class="dfn-paneled" data-dfn-type="dfn" data-export="" id="endpoint">endpoint</dfn> is location to which <a data-link-type="dfn" href="#report" id="ref-for-report">reports</a> may be sent.</p>
    <p>Each <a data-link-type="dfn" href="#endpoint" id="ref-for-endpointâ ">endpoint</a> has a <dfn class="dfn-paneled idl-code" data-dfn-for="endpoint" data-dfn-type="attribute" data-export="" id="dom-endpoint-url"><code>url</code></dfn>,
  which is a <code class="idl"><a data-link-type="idl" href="https://url.spec.whatwg.org/#concept-url" id="ref-for-concept-url">URL</a></code>.</p>
    <p>Each <a data-link-type="dfn" href="#endpoint" id="ref-for-endpointâ¡">endpoint</a> has a <dfn class="dfn-paneled idl-code" data-dfn-for="endpoint" data-dfn-type="attribute" data-export="" id="dom-endpoint-failures"><code>failures</code></dfn>, which is a non-negative
  integer representing the number of consecutive times this endpoint has failed
  to respond to a request.</p>
    <p>Each <a data-link-type="dfn" href="#endpoint" id="ref-for-endpointâ¢">endpoint</a> has a <dfn class="dfn-paneled idl-code" data-dfn-for="endpoint" data-dfn-type="attribute" data-export="" id="dom-endpoint-retry-after"><code>retry-after</code></dfn>, which is either <code>null</code>, or a timestamp after which delivery should be retried.</p>
    <p>Each <a data-link-type="dfn" href="#endpoint" id="ref-for-endpointâ£">endpoint</a> has a <dfn class="dfn-paneled idl-code" data-dfn-for="endpoint" data-dfn-type="attribute" data-export="" id="dom-endpoint-clients"><code>clients</code></dfn> list, which is a list of <a data-link-type="dfn" href="#client" id="ref-for-client">clients</a>.</p>
    <p>An <a data-link-type="dfn" href="#endpoint" id="ref-for-endpointâ¤">endpoint</a> is <dfn class="dfn-paneled" data-dfn-for="endpoint" data-dfn-type="dfn" data-noexport="" id="endpoint-expired">expired</dfn> if every <a data-link-type="dfn" href="#client" id="ref-for-clientâ ">client</a> in its list of <code class="idl"><a data-link-type="idl" href="#dom-endpoint-clients" id="ref-for-dom-endpoint-clients">clients</a></code> is <a data-link-type="dfn" href="#client-expired" id="ref-for-client-expired">expired</a>.</p>
    <p>An <a data-link-type="dfn" href="#endpoint" id="ref-for-endpointâ¥">endpoint</a> is <dfn class="dfn-paneled" data-dfn-for="endpoint" data-dfn-type="dfn" data-noexport="" id="endpoint-pending">pending</dfn> if its <code class="idl"><a data-link-type="idl" href="#dom-endpoint-retry-after" id="ref-for-dom-endpoint-retry-after">retry-after</a></code> is not <code>null</code>, and represents a time in the future.</p>
    <h3 class="heading settled" data-level="2.2" id="concept-client"><span class="secno">2.2. </span><span class="content">Clients</span><a class="self-link" href="#concept-client"></a></h3>
    <p>A <dfn class="dfn-paneled" data-dfn-type="dfn" data-export="" id="client">client</dfn> represents a particular originâs relationship to
  an <a data-link-type="dfn" href="#endpoint" id="ref-for-endpointâ¦">endpoint</a>.</p>
    <p>Each <a data-link-type="dfn" href="#client" id="ref-for-clientâ¡">client</a> has an <dfn class="dfn-paneled idl-code" data-dfn-for="client" data-dfn-type="attribute" data-export="" id="dom-client-origin"><code>origin</code></dfn>,
  which is an <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/browsers.html#origin" id="ref-for-origin">origin</a>.</p>
    <p>Each <a data-link-type="dfn" href="#client" id="ref-for-clientâ¢">client</a> has a <dfn class="dfn-paneled idl-code" data-dfn-for="client" data-dfn-type="attribute" data-export="" id="dom-client-subdomains"><code>subdomains</code></dfn> flag (which is either "<code>include</code>" or "<code>exclude</code>").</p>
    <p>Each <a data-link-type="dfn" href="#client" id="ref-for-clientâ£">client</a> has a <dfn class="dfn-paneled idl-code" data-dfn-for="client" data-dfn-type="attribute" data-export="" id="dom-client-group"><code>group</code></dfn> which
  is an ASCII string.</p>
    <p>Each <a data-link-type="dfn" href="#client" id="ref-for-clientâ¤">client</a> has a <dfn class="dfn-paneled idl-code" data-dfn-for="client" data-dfn-type="attribute" data-export="" id="dom-client-ttl"><code>ttl</code></dfn> representing the the number of seconds the client remains valid for an <a data-link-type="dfn" href="#endpoint" id="ref-for-endpointâ§">endpoint</a>.</p>
    <p>Each <a data-link-type="dfn" href="#client" id="ref-for-clientâ¥">client</a> has a <dfn class="dfn-paneled idl-code" data-dfn-for="client" data-dfn-type="attribute" data-export="" id="dom-client-creation"><code>creation</code></dfn> which is the timestamp at which the client was added to an <a data-link-type="dfn" href="#endpoint" id="ref-for-endpointâ¨">endpoint</a>.</p>
    <p>A <a data-link-type="dfn" href="#client" id="ref-for-clientâ¦">client</a> is <dfn class="dfn-paneled" data-dfn-for="client" data-dfn-type="dfn" data-noexport="" id="client-expired">expired</dfn> if its <code class="idl"><a data-link-type="idl" href="#dom-client-creation" id="ref-for-dom-client-creation">creation</a></code> plus its <code class="idl"><a data-link-type="idl" href="#dom-client-ttl" id="ref-for-dom-client-ttl">ttl</a></code> represents a time in the past.</p>
    <h3 class="heading settled" data-level="2.3" id="concept-reports"><span class="secno">2.3. </span><span class="content">Reports</span><a class="self-link" href="#concept-reports"></a></h3>
    <p>A <dfn class="dfn-paneled" data-dfn-type="dfn" data-export="" id="report">report</dfn> is a collection of arbitrary data which the user
  agent is expected to deliver to a specified endpoint.</p>
    <p>Each <a data-link-type="dfn" href="#report" id="ref-for-reportâ ">report</a> has a <dfn class="dfn-paneled" data-dfn-for="report" data-dfn-type="dfn" data-export="" id="report-body">body</dfn>,
  which is either <code>null</code> or an object which can be serialized into a <a data-link-type="dfn" href="https://tools.ietf.org/html/rfc7159#section-2" id="ref-for-section-2">JSON
  text</a>.</p>
    <p>Each <a data-link-type="dfn" href="#report" id="ref-for-reportâ¡">report</a> has an <dfn class="dfn-paneled" data-dfn-for="report" data-dfn-type="dfn" data-export="" id="report-url">url</dfn>,
  which is the address of the <code>Document</code> or <code>Worker</code> from which the report was
  generated.</p>
    <p class="note" role="note"><span>Note:</span> We strip the username, password, and fragment from this serialized URL.
  See <a href="#capability-urls">Â§8.1 Capability URLs</a>.</p>
    <p>Each <a data-link-type="dfn" href="#report" id="ref-for-reportâ¢">report</a> has an <dfn class="dfn-paneled" data-dfn-for="report" data-dfn-type="dfn" data-export="" id="report-origin">origin</dfn>,
  which is an <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/browsers.html#origin" id="ref-for-originâ ">origin</a> representing the reportâs initiator.</p>
    <p>Each <a data-link-type="dfn" href="#report" id="ref-for-reportâ£">report</a> has an <dfn class="dfn-paneled" data-dfn-for="report" data-dfn-type="dfn" data-export="" id="report-group">group</dfn>,
  which is a string representing the <code class="idl"><a data-link-type="idl" href="#dom-client-group" id="ref-for-dom-client-group">group</a></code> to which this report
  will be sent.</p>
    <p>Each <a data-link-type="dfn" href="#report" id="ref-for-reportâ¤">report</a> has a <dfn class="dfn-paneled" data-dfn-for="report" data-dfn-type="dfn" data-export="" id="report-type">type</dfn>,
  which is a non-empty string specifying the type of data the report contains.</p>
    <p>Each <a data-link-type="dfn" href="#report" id="ref-for-reportâ¥">report</a> has a <dfn class="dfn-paneled" data-dfn-for="report" data-dfn-type="dfn" data-export="" id="report-timestamp">timestamp</dfn>,
  which records the time at which the report was generated, in milliseconds
  since the unix epoch.</p>
    <p>Each <a data-link-type="dfn" href="#report" id="ref-for-reportâ¦">report</a> has a <dfn class="dfn-paneled" data-dfn-for="report" data-dfn-type="dfn" data-export="" id="report-attempts">attempts</dfn>,
  which is a non-negative integer representing the number of times the user
  agent attempted to deliver the report.</p>
    <h3 class="heading settled" data-level="2.4" id="concept-storage"><span class="secno">2.4. </span><span class="content">Storage</span><a class="self-link" href="#concept-storage"></a></h3>
    <p>A conformant user agent MUST provide a <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport="" id="reporting-cache">reporting cache</dfn>, which
  is a storage mechanism that maintains a set of <a data-link-type="dfn" href="#endpoint" id="ref-for-endpointâ âª">endpoints</a> that websites
  have instructed the user agent to associate with their <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/browsers.html#origin" id="ref-for-originâ¡">origins</a>, and a set of <a data-link-type="dfn" href="#report" id="ref-for-reportâ§">reports</a> which are queued for
  delivery.</p>
    <p>This storage mechanism is opaque, vendor-specific, and not exposed to the
  web, but it MUST provide the following methods which will be used in the
  algorithms this document defines:</p>
    <ol>
     <li data-md="">
      <p>Insert, update, and remove <a data-link-type="dfn" href="#endpoint" id="ref-for-endpointâ â ">endpoints</a>.</p>
     <li data-md="">
      <p>Enqueue and dequeue <a data-link-type="dfn" href="#report" id="ref-for-reportâ¨">reports</a> for delivery.</p>
     <li data-md="">
      <p>Retrieve a list of <a data-link-type="dfn" href="#endpoint" id="ref-for-endpointâ â¡">endpoint</a> objects.</p>
     <li data-md="">
      <p>Retrieve a list of queued <a data-link-type="dfn" href="#report" id="ref-for-reportâ âª">report</a> objects.</p>
     <li data-md="">
      <p>Clear the cache.</p>
    </ol>
   </section>
   <section>
    <h2 class="heading settled" data-level="3" id="endpoint-delivery"><span class="secno">3. </span><span class="content">Endpoint Delivery</span><a class="self-link" href="#endpoint-delivery"></a></h2>
    <p>A server MAY define a set of reporting endpoints for an origin it controls
  via the <a data-link-type="dfn" href="#report-to" id="ref-for-report-toâ¡"><code>Report-To</code></a> HTTP response header field. This mechanism
  is defined in <a href="#header">Â§3.1 The Report-To HTTP Response Header Field</a>, and its processing in <a href="#process-header">Â§3.2 Process reporting endpoints for response to request</a>.</p>
    <h3 class="heading settled" data-level="3.1" id="header"><span class="secno">3.1. </span><span class="content">The <code>Report-To</code> HTTP Response Header Field</span><a class="self-link" href="#header"></a></h3>
    <p>The <dfn class="dfn-paneled" data-dfn-type="dfn" data-export="" id="report-to"><code>Report-To</code></dfn> HTTP response header field instructs the
  user agent to store reporting endpoints for an origin. The header is
  represented by the following ABNF grammar <a data-link-type="biblio" href="#biblio-rfc5234">[RFC5234]</a>:</p>
<pre class="abnf">Report-To = <a data-link-type="grammar" href="https://greenbytes.de/tech/webdav/draft-reschke-http-jfv-02.html#rfc.section.2" id="ref-for-rfc.section.2">json-field-value</a>
            ; See Section 2 of [[HTTP-JFV]], and Section 2 of [[RFC7159]]
</pre>
    <p>The headerâs value is interpreted as an array of JSON objects, as described in
  Section 4 of <a data-link-type="biblio" href="#biblio-http-jfv">[HTTP-JFV]</a>.</p>
    <p>Each object in the array defines an <a data-link-type="dfn" href="#endpoint" id="ref-for-endpointâ â¢">endpoint</a> to which reports may be
  delivered, and will be parsed as defined in <a href="#parse-header">Â§3.3 Parse reporting endpoint tuples from value</a>.</p>
    <p>The following subsections defined the initial set of known members in each
  JSON object the headerâs value defines. Future versions of this document may
  define additional such members, and user agents MUST ignore unknown members
  when parsing the header.</p>
    <h4 class="heading settled" data-level="3.1.1" id="url-member"><span class="secno">3.1.1. </span><span class="content">The <code>url</code> member</span><a class="self-link" href="#url-member"></a></h4>
    <p>The REQUIRED <dfn class="dfn-paneled" data-dfn-for="ReportTo" data-dfn-type="dfn" data-noexport="" id="reportto-url"><code>url</code></dfn> member is a string that defines
  the location of a reporting endpoint. The memberâs value MUST be a string; any
  other type will result in a parse error.</p>
    <p>Moreover, the URL that the memberâs value represents MUST be <a data-link-type="dfn" href="https://w3c.github.io/webappsec-secure-contexts/#is-origin-trustworthy" id="ref-for-is-origin-trustworthy">potentially
  trustworthy</a> <a data-link-type="biblio" href="#biblio-secure-contexts">[SECURE-CONTEXTS]</a>. Non-secure endpoints will be ignored.</p>
    <h4 class="heading settled" data-level="3.1.2" id="id-member"><span class="secno">3.1.2. </span><span class="content">The <code>group</code> member</span><a class="self-link" href="#id-member"></a></h4>
    <p>The OPTIONAL <dfn class="dfn-paneled" data-dfn-for="ReportTo" data-dfn-type="dfn" data-noexport="" id="reportto-group"><code>group</code></dfn> member is a string that
  associates a name with the reporting endpoint. The memberâs value MUST be a
  string; any other type will result in a parse error. If no member named
  "<code>group</code>" is present in the object, the <a data-link-type="dfn" href="#endpoint" id="ref-for-endpointâ â£">endpoint</a> will be associated
  with a group named "<code>default</code>".</p>
    <p>The group name is not unique and multiple endpoints may use the same name to
  create a set of reporting endpoints that can be used for backup and failover
  purposes. If the member is omitted, the endpoint MUST be associated with
  the "default" group name.</p>
    <p class="note" role="note"><span>Note:</span> If a group resolves to multiple <a data-link-type="dfn" href="#endpoint" id="ref-for-endpointâ â¤">endpoints</a>, the user agent will
  deliver a particular <a data-link-type="dfn" href="#report" id="ref-for-reportâ â ">report</a> to <strong>at most one</strong> <a data-link-type="dfn" href="#endpoint" id="ref-for-endpointâ â¥">endpoint</a> in that group on a best-effort basis.</p>
    <h4 class="heading settled" data-level="3.1.3" id="includesubdomains-member"><span class="secno">3.1.3. </span><span class="content">The <code>includeSubdomains</code> member</span><a class="self-link" href="#includesubdomains-member"></a></h4>
    <p>The OPTIONAL <dfn class="dfn-paneled" data-dfn-for="ReportTo" data-dfn-type="dfn" data-noexport="" id="reportto-includesubdomains"><code>includeSubdomains</code></dfn> member is a boolean
  that enables an endpoint for all subdomains of the current <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/browsers.html#origin" id="ref-for-originâ¢">origin</a>âs <code class="idl"><a data-link-type="idl" href="https://url.spec.whatwg.org/#dom-url-host" id="ref-for-dom-url-host">host</a></code>.  If no member named
  "<code>includeSubdomains</code>" is present in the object, or its value is not "<code>true</code>",
  the endpoint will not be enabled for subdomains.</p>
    <h4 class="heading settled" data-level="3.1.4" id="max-age-member"><span class="secno">3.1.4. </span><span class="content">The <code>max-age</code> member</span><a class="self-link" href="#max-age-member"></a></h4>
    <p>The REQUIRED <dfn class="dfn-paneled" data-dfn-for="ReportTo" data-dfn-type="dfn" data-export="" id="reportto-max-age"><code>max-age</code></dfn> member defines the
  reporting endpointâs lifetime, as a non-negative integer number of seconds.
  The memberâs value MUST be a number; any other type will result in a parse
  error.</p>
    <p>A value of "<code>0</code>" will cause the <a data-link-type="dfn" href="#endpoint" id="ref-for-endpointâ â¦">endpoint</a> to be removed from the user
  agentâs <a data-link-type="dfn" href="#reporting-cache" id="ref-for-reporting-cache">reporting cache</a>.</p>
    <h3 class="heading settled algorithm" data-algorithm="Process reporting endpoints for response to request" data-level="3.2" id="process-header"><span class="secno">3.2. </span><span class="content"> Process reporting endpoints for <var>response</var> to <var>request</var> </span><a class="self-link" href="#process-header"></a></h3>
    <p>Given a <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-response" id="ref-for-concept-response">response</a> (<var>response</var>) and a <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request" id="ref-for-concept-request">request</a> (<var>request</var>), this
  algorithm extracts a list of <a data-link-type="dfn" href="#endpoint" id="ref-for-endpointâ â§">endpoint</a> objects, and updates the <a data-link-type="dfn" href="#reporting-cache" id="ref-for-reporting-cacheâ ">reporting cache</a> accordingly.</p>
    <p class="note" role="note"><span>Note:</span> This algorithm is called from around step 13 of <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#main-fetch" id="ref-for-main-fetch">main fetch</a> <a data-link-type="biblio" href="#biblio-fetch">[FETCH]</a>, and only updates the <a data-link-type="dfn" href="#reporting-cache" id="ref-for-reporting-cacheâ¡">reporting cache</a> if the <var>response</var> has been delivered securely.</p>
    <p class="issue" id="issue-59ca7a64"><a class="self-link" href="#issue-59ca7a64"></a> Fetch monkey patching. Talk to Anne.</p>
    <ol>
     <li data-md="">
      <p>Abort these steps if any of the following conditions are true:</p>
      <ol>
       <li data-md="">
        <p><var>response</var>âs <a class="idl-code" data-link-type="attribute" href="https://fetch.spec.whatwg.org/#concept-response-https-state" id="ref-for-concept-response-https-state">HTTPS state</a> is not
  "<code>modern</code>", and the <a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url-origin" id="ref-for-concept-url-origin">origin</a> of <var>response</var>âs <a class="idl-code" data-link-type="attribute" href="https://fetch.spec.whatwg.org/#concept-response-url" id="ref-for-concept-response-url">url</a> is not <a data-link-type="dfn" href="https://w3c.github.io/webappsec-secure-contexts/#is-origin-trustworthy" id="ref-for-is-origin-trustworthyâ ">potentially
  trustworthy</a>.</p>
       <li data-md="">
        <p><var>response</var>âs <a class="idl-code" data-link-type="attribute" href="https://fetch.spec.whatwg.org/#concept-response-header-list" id="ref-for-concept-response-header-list">header list</a> does not
  contain a <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-header" id="ref-for-concept-header">header</a> whose <a class="idl-code" data-link-type="attribute" href="https://fetch.spec.whatwg.org/#concept-header-name" id="ref-for-concept-header-name">name</a> is
  "<a data-link-type="dfn" href="#report-to" id="ref-for-report-toâ¢"><code>Report-To</code></a>".</p>
      </ol>
     <li data-md="">
      <p>Let <var>header</var> be the <a class="idl-code" data-link-type="attribute" href="https://fetch.spec.whatwg.org/#concept-header-value" id="ref-for-concept-header-value">value</a> of the <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-header" id="ref-for-concept-headerâ ">header</a> in <var>response</var>âs <a class="idl-code" data-link-type="attribute" href="https://fetch.spec.whatwg.org/#concept-response-header-list" id="ref-for-concept-response-header-listâ ">header list</a> whose name is "<a data-link-type="dfn" href="#report-to" id="ref-for-report-toâ£"><code>Report-To</code></a>".</p>
     <li data-md="">
      <p>Let <var>origin</var> be the <a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url-origin" id="ref-for-concept-url-originâ ">origin</a> of <var>response</var>âs <a class="idl-code" data-link-type="attribute" href="https://fetch.spec.whatwg.org/#concept-response-url" id="ref-for-concept-response-urlâ ">url</a>.</p>
     <li data-md="">
      <p>Let <var>tuples</var> be the result of executing <a href="#parse-header">Â§3.3 Parse reporting endpoint tuples from value</a> on <var>header</var>.</p>
     <li data-md="">
      <p>For each <var>tuple</var> in <var>tuples</var>:</p>
      <ol>
       <li data-md="">
        <p>Let <var>new</var> be a new <a data-link-type="dfn" href="#client" id="ref-for-clientâ§">client</a> whose properties are set as follows:</p>
        <dl>
         <dt data-md=""><code class="idl"><a data-link-type="idl" href="#dom-client-origin" id="ref-for-dom-client-origin">origin</a></code>
         <dd data-md="">
          <p><var>origin</var></p>
         <dt data-md=""><code class="idl"><a data-link-type="idl" href="#dom-client-subdomains" id="ref-for-dom-client-subdomains">subdomains</a></code>
         <dd data-md="">
          <p><var>tuple</var>âs <code class="idl"><a data-link-type="idl" href="#dom-client-subdomains" id="ref-for-dom-client-subdomainsâ ">subdomains</a></code></p>
         <dt data-md=""><code class="idl"><a data-link-type="idl" href="#dom-client-group" id="ref-for-dom-client-groupâ ">group</a></code>
         <dd data-md="">
          <p><var>tuple</var>âs <code class="idl"><a data-link-type="idl" href="#dom-client-group" id="ref-for-dom-client-groupâ¡">group</a></code></p>
         <dt data-md=""><code class="idl"><a data-link-type="idl" href="#dom-client-ttl" id="ref-for-dom-client-ttlâ ">ttl</a></code>
         <dd data-md="">
          <p><var>tuple</var>âs <code class="idl"><a data-link-type="idl" href="#dom-client-ttl" id="ref-for-dom-client-ttlâ¡">ttl</a></code></p>
         <dt data-md=""><code class="idl"><a data-link-type="idl" href="#dom-client-creation" id="ref-for-dom-client-creationâ ">creation</a></code>
         <dd data-md="">
          <p>The current timestamp</p>
        </dl>
       <li data-md="">
        <p>If there exists an <a data-link-type="dfn" href="#endpoint" id="ref-for-endpointâ â¨">endpoint</a> (<var>endpoint</var>) in the <a data-link-type="dfn" href="#reporting-cache" id="ref-for-reporting-cacheâ¢">reporting
  cache</a> whose <code class="idl"><a data-link-type="idl" href="#dom-endpoint-url" id="ref-for-dom-endpoint-url">url</a></code> is <var>tuple</var>âs <code class="idl"><a data-link-type="idl" href="https://url.spec.whatwg.org/#concept-url" id="ref-for-concept-urlâ ">URL</a></code>:</p>
        <ol>
         <li data-md="">
          <p>For each <var>client</var> in <var>endpoint</var>âs <code class="idl"><a data-link-type="idl" href="#dom-endpoint-clients" id="ref-for-dom-endpoint-clientsâ ">clients</a></code>, delete <var>client</var> if <var>new</var>âs <code class="idl"><a data-link-type="idl" href="#dom-client-origin" id="ref-for-dom-client-originâ ">origin</a></code> is the same as <var>client</var>âs <code class="idl"><a data-link-type="idl" href="#dom-client-origin" id="ref-for-dom-client-originâ¡">origin</a></code>.</p>
         <li data-md="">
          <p>If <var>new</var>âs <code class="idl"><a data-link-type="idl" href="#dom-client-ttl" id="ref-for-dom-client-ttlâ¢">ttl</a></code> is greater than 0, append <var>new</var> to <var>endpoint</var>âs <code class="idl"><a data-link-type="idl" href="#dom-endpoint-clients" id="ref-for-dom-endpoint-clientsâ¡">clients</a></code> list.</p>
         <li data-md="">
          <p>Skip to the next <var>tuple</var>.</p>
        </ol>
       <li data-md="">
        <p>Otherwise, there is no existing <a data-link-type="dfn" href="#endpoint" id="ref-for-endpointâ¡âª">endpoint</a>, so let <var>endpoint</var> be a new <a data-link-type="dfn" href="#endpoint" id="ref-for-endpointâ¡â ">endpoint</a> whose properties are set as follows:</p>
        <dl>
         <dt data-md=""><code class="idl"><a data-link-type="idl" href="#dom-endpoint-url" id="ref-for-dom-endpoint-urlâ ">url</a></code>
         <dd data-md="">
          <p><var>tuple</var>âs <code class="idl"><a data-link-type="idl" href="https://url.spec.whatwg.org/#concept-url" id="ref-for-concept-urlâ¡">URL</a></code></p>
         <dt data-md=""><code class="idl"><a data-link-type="idl" href="#dom-endpoint-failures" id="ref-for-dom-endpoint-failures">failures</a></code>
         <dd data-md="">
          <p>0</p>
         <dt data-md=""><code class="idl"><a data-link-type="idl" href="#dom-endpoint-retry-after" id="ref-for-dom-endpoint-retry-afterâ ">retry-after</a></code>
         <dd data-md="">
          <p><code>null</code></p>
         <dt data-md=""><code class="idl"><a data-link-type="idl" href="#dom-endpoint-clients" id="ref-for-dom-endpoint-clientsâ¢">clients</a></code>
         <dd data-md="">
          <p>A new list, containing <var>tuple</var></p>
        </dl>
       <li data-md="">
        <p>Insert <var>endpoint</var> into the <a data-link-type="dfn" href="#reporting-cache" id="ref-for-reporting-cacheâ£">reporting cache</a> for <var>origin</var>.</p>
      </ol>
    </ol>
    <h3 class="heading settled algorithm" data-algorithm="Parse reporting endpoint tuples from value" data-level="3.3" id="parse-header"><span class="secno">3.3. </span><span class="content"> Parse reporting endpoint tuples from <var>value</var> </span><a class="self-link" href="#parse-header"></a></h3>
    <p>Given a string (<var>value</var>) this algorithm will return a list of tuples
  containing a <code class="idl"><a data-link-type="idl" href="https://url.spec.whatwg.org/#concept-url" id="ref-for-concept-urlâ¢">URL</a></code>, <code class="idl"><a data-link-type="idl" href="#dom-client-subdomains" id="ref-for-dom-client-subdomainsâ¡">subdomains</a></code> flag, <code class="idl"><a data-link-type="idl" href="#dom-client-ttl" id="ref-for-dom-client-ttlâ£">ttl</a></code>, and a <code class="idl"><a data-link-type="idl" href="#dom-client-group" id="ref-for-dom-client-groupâ¢">group</a></code>. This list will be empty if no valid endpoints could be
  parsed.</p>
    <ol>
     <li data-md="">
      <p>Let <var>list</var> be the result of executing the algorithm defined in Section 4
  of <a data-link-type="biblio" href="#biblio-http-jfv">[HTTP-JFV]</a>. If that algorithm results in an error, abort these steps.</p>
     <li data-md="">
      <p>Let <var>tuples</var> be an empty list.</p>
     <li data-md="">
      <p>For each <var>item</var> in <var>list</var>:</p>
      <ol>
       <li data-md="">
        <p>If <var>item</var> has no member named "<a data-link-type="dfn" href="#reportto-url" id="ref-for-reportto-urlâ£"><code>url</code></a>", or that
  memberâs value is not a string, skip to the next <var>item</var>.</p>
       <li data-md="">
        <p>If <var>item</var> has no member named "<a data-link-type="dfn" href="#reportto-max-age" id="ref-for-reportto-max-ageâ£"><code>max-age</code></a>", or
  that memberâs value is not a number, skip to the next <var>item</var>.</p>
       <li data-md="">
        <p>Let <var>tuple</var> be a new tuple containing the following:</p>
        <dl>
         <dt data-md="">"<code>url</code>"
         <dd data-md="">
          <p>The result of executing the <a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url-parser" id="ref-for-concept-url-parser">URL parser</a> on <var>item</var>âs
  "<a data-link-type="dfn" href="#reportto-url" id="ref-for-reportto-urlâ¤"><code>url</code></a>" memberâs value.</p>
         <dt data-md="">"<code>subdomains</code>"
         <dd data-md="">
          <p>"<code>Include</code>" if <var>item</var> has a member named
  "<a data-link-type="dfn" href="#reportto-includesubdomains" id="ref-for-reportto-includesubdomains"><code>includeSubdomains</code></a>" whose value is <code>true</code>,
  "<code>Exclude</code>" otherwise.</p>
         <dt data-md="">"<code>ttl</code>"
         <dd data-md="">
          <p><var>item</var>âs "<a data-link-type="dfn" href="#reportto-max-age" id="ref-for-reportto-max-ageâ¤"><code>max-age</code></a>" memberâs value.</p>
         <dt data-md="">"<code>group</code>"
         <dd data-md="">
          <p><var>item</var>âs "<a data-link-type="dfn" href="#reportto-group" id="ref-for-reportto-groupâ£"><code>group</code></a>" memberâs value if
  present, and "<code>default</code>" otherwise.</p>
        </dl>
       <li data-md="">
        <p>If <var>tuple</var>âs "<code>url</code>" is not <a data-link-type="dfn" href="https://w3c.github.io/webappsec-secure-contexts/#is-origin-trustworthy" id="ref-for-is-origin-trustworthyâ¡">potentially trustworthy</a>, or <var>tuple</var>âs "<code>ttl</code>" is a negative number, skip to the next <var>item</var>.</p>
        <p class="note" role="note"><span>Note:</span> User agents SHOULD raise some sort of developer-visible parse
  error in this case.</p>
       <li data-md="">
        <p>Append <var>tuple</var> to <var>tuples</var>.</p>
      </ol>
     <li data-md="">
      <p>Return <var>tuples</var>.</p>
    </ol>
   </section>
   <section>
    <h2 class="heading settled" data-level="4" id="report-delivery"><span class="secno">4. </span><span class="content">Report Delivery</span><a class="self-link" href="#report-delivery"></a></h2>
    <p>Over time, various features will queue up a list of <a data-link-type="dfn" href="#report" id="ref-for-reportâ â¡">reports</a> in the
  user agentâs <a data-link-type="dfn" href="#reporting-cache" id="ref-for-reporting-cacheâ¤">reporting cache</a>. The user agent will periodically grab
  the list of currently pending reports, and deliver them to the associated
  endpoints. This document does not define a schedule for the user agent to
  follow, and assumes that the user agent will have enough contextual
  information to deliver reports in a timely manner, balanced against impacting
  a userâs experience.</p>
    <p>That said, a user agent SHOULD make a effort to deliver reports as soon as
  possible after queuing, as a reportâs data might be significantly more useful
  in the period directly after its generation than it would be a day or a week
  later.</p>
    <h3 class="heading settled algorithm" data-algorithm="Queue data as type for endpoint group on settings" data-level="4.1" id="queue-report"><span class="secno">4.1. </span><span class="content"> Queue <var>data</var> as <var>type</var> for <var>endpoint group</var> on <var>settings</var> </span><a class="self-link" href="#queue-report"></a></h3>
    <p>Given a serializable object (<var>data</var>), a string (<var>type</var>), another string
  (<var>endpoint group</var>), and an <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#environment-settings-object" id="ref-for-environment-settings-object">environment settings object</a> (<var>settings</var>),
  the following algorithm will create a <a data-link-type="dfn" href="#report" id="ref-for-reportâ â¢">report</a>, and add it to <a data-link-type="dfn" href="#reporting-cache" id="ref-for-reporting-cacheâ¥">reporting cache</a>âs queue for future delivery.</p>
    <ol>
     <li data-md="">
      <p>Let <var>report</var> be a new <a data-link-type="dfn" href="#report" id="ref-for-reportâ â£">report</a> object with its values initialized as
  follows:</p>
      <dl>
       <dt data-md=""><a data-link-type="dfn" href="#report-body" id="ref-for-report-body">body</a>
       <dd data-md="">
        <p><var>data</var></p>
       <dt data-md=""><a data-link-type="dfn" href="#report-origin" id="ref-for-report-origin">origin</a>
       <dd data-md="">
        <p><var>settings</var>âs <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/browsers.html#origin" id="ref-for-originâ£">origin</a></p>
       <dt data-md=""><a data-link-type="dfn" href="#report-group" id="ref-for-report-group">group</a>
       <dd data-md="">
        <p><var>endpoint group</var></p>
       <dt data-md=""><a data-link-type="dfn" href="#report-type" id="ref-for-report-type">type</a>
       <dd data-md="">
        <p><var>type</var></p>
       <dt data-md=""><a data-link-type="dfn" href="#report-timestamp" id="ref-for-report-timestamp">timestamp</a>
       <dd data-md="">
        <p>The current timestamp.</p>
       <dt data-md=""><a data-link-type="dfn" href="#report-attempts" id="ref-for-report-attempts">attempts</a>
       <dd data-md="">
        <p>0</p>
      </dl>
     <li data-md="">
      <p>Let <var>url</var> be <var>settings</var>âs <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#creation-url" id="ref-for-creation-url">creation URL</a>.</p>
     <li data-md="">
      <p>Set <var>url</var>âs <code class="idl"><a data-link-type="idl" href="https://url.spec.whatwg.org/#concept-url-username" id="ref-for-concept-url-username">username</a></code> to the empty string, and its <code class="idl"><a data-link-type="idl" href="https://url.spec.whatwg.org/#concept-url-password" id="ref-for-concept-url-password">password</a></code> to <code>null</code>.</p>
     <li data-md="">
      <p>Set <var>report</var>âs <a data-link-type="dfn" href="#report-url" id="ref-for-report-url">url</a> to the result of executing the <a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url-serializer" id="ref-for-concept-url-serializer">URL
  serializer</a> on <var>url</var> with the <em>exclude fragment flag</em> set.</p>
     <li data-md="">
      <p>Add <var>report</var> to the <a data-link-type="dfn" href="#reporting-cache" id="ref-for-reporting-cacheâ¦">reporting cache</a>.</p>
     <li data-md="">
      <p>Execute <a href="#notify-observers">Â§5.2 Notify reporting observers on settings with report.</a> with <var>settings</var> and <var>report</var>.</p>
    </ol>
    <p class="note" role="note"><span>Note:</span> We strip the username, password, and fragment from the serialized URL
  in the report. See <a href="#capability-urls">Â§8.1 Capability URLs</a>.</p>
    <p class="note" role="note"><span>Note:</span> The user agent MAY reject reports for any reason. This API does not
  guarantee delivery of arbitrary amounts of data, for instance.</p>
    <h3 class="heading settled" data-level="4.2" id="does-endpoint-match-report"><span class="secno">4.2. </span><span class="content"> Does <var>endpoint</var> match <var>report</var>? </span><a class="self-link" href="#does-endpoint-match-report"></a></h3>
    <p>Given an <a data-link-type="dfn" href="#endpoint" id="ref-for-endpointâ¡â¡">endpoint</a> (<var>endpoint</var>) and a <a data-link-type="dfn" href="#report" id="ref-for-reportâ â¤">report</a> (<var>report</var>), this
  algorithm returns "<code>Match</code>" if <var>report</var> should be sent to <var>endpoint</var>, and
  "<code>Does Not Match</code>" otherwise:</p>
    <ol>
     <li data-md="">
      <p>For each <var>client</var> in <var>endpoint</var>âs <code class="idl"><a data-link-type="idl" href="#dom-endpoint-clients" id="ref-for-dom-endpoint-clientsâ£">clients</a></code>:</p>
      <ol>
       <li data-md="">
        <p>If <var>client</var> is <a data-link-type="dfn" href="#client-expired" id="ref-for-client-expiredâ ">expired</a>, skip to the next <var>client</var>.</p>
        <p class="note" role="note"><span>Note:</span> In this case, the user agent MAY remove <var>client</var> from <var>endpoint</var>, or it may wait and collect garbage <i lang="fr">en
  masse</i> at some point in the future as described in <a href="#gc">Â§6.2 Garbage Collection</a>.</p>
       <li data-md="">
        <p>Return "<code>Match</code>" if each of the following criteria is met:</p>
        <ol>
         <li data-md="">
          <p><var>report</var>âs <a data-link-type="dfn" href="#report-group" id="ref-for-report-groupâ ">group</a> is an <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/infrastructure.html#ascii-case-insensitive" id="ref-for-ascii-case-insensitive">ASCII case-insensitive</a> match for <var>client</var>âs <code class="idl"><a data-link-type="idl" href="#dom-client-group" id="ref-for-dom-client-groupâ£">group</a></code></p>
         <li data-md="">
          <p>If <var>client</var>âs <code class="idl"><a data-link-type="idl" href="#dom-client-subdomains" id="ref-for-dom-client-subdomainsâ¢">subdomains</a></code> is "<code>exclude</code>", <var>report</var>âs <a data-link-type="dfn" href="#report-origin" id="ref-for-report-originâ ">origin</a> is the same as <var>client</var>âs <code class="idl"><a data-link-type="idl" href="#dom-client-origin" id="ref-for-dom-client-originâ¢">origin</a></code></p>
          <p>Otherwise, <var>report</var>âs <a data-link-type="dfn" href="#report-origin" id="ref-for-report-originâ¡">origin</a>'s <code class="idl"><a data-link-type="idl" href="https://url.spec.whatwg.org/#dom-url-host" id="ref-for-dom-url-hostâ ">host</a></code> is either a <a data-link-type="dfn" href="https://tools.ietf.org/html/rfc6797#section-8.2" id="ref-for-section-8.2">superdomain match</a> or <a data-link-type="dfn" href="https://tools.ietf.org/html/rfc6797#section-8.2" id="ref-for-section-8.2â ">congruent match</a> for <var>client</var>âs <code class="idl"><a data-link-type="idl" href="#dom-client-origin" id="ref-for-dom-client-originâ£">origin</a></code>'s <code class="idl"><a data-link-type="idl" href="https://url.spec.whatwg.org/#dom-url-host" id="ref-for-dom-url-hostâ¡">host</a></code> <a data-link-type="biblio" href="#biblio-rfc6797">[RFC6797]</a></p>
        </ol>
      </ol>
     <li data-md="">
      <p>Return "<code>Does Not Match</code>".</p>
    </ol>
    <h3 class="heading settled algorithm" data-algorithm="Send reports" data-level="4.3" id="send-reports"><span class="secno">4.3. </span><span class="content"> Send reports </span><a class="self-link" href="#send-reports"></a></h3>
    <p>A user agent sends reports by executing the following steps:</p>
    <ol>
     <li data-md="">
      <p>Let <var>reports</var> be a copy of the list of queued <a data-link-type="dfn" href="#report" id="ref-for-reportâ â¥">report</a> objects in <a data-link-type="dfn" href="#reporting-cache" id="ref-for-reporting-cacheâ§">reporting cache</a>.</p>
     <li data-md="">
      <p>Let <var>endpoint map</var> be an empty map of <a data-link-type="dfn" href="#endpoint" id="ref-for-endpointâ¡â¢">endpoint</a> objects to lists of <a data-link-type="dfn" href="#report" id="ref-for-reportâ â¦">report</a> objects.</p>
     <li data-md="">
      <p>For each <var>report</var> in <var>reports</var>:</p>
      <ol>
       <li data-md="">
        <p>For <var>endpoint</var> in the <a data-link-type="dfn" href="#reporting-cache" id="ref-for-reporting-cacheâ¨">reporting cache</a>:</p>
        <ol>
         <li data-md="">
          <p>If <var>endpoint</var> is <a data-link-type="dfn" href="#endpoint-expired" id="ref-for-endpoint-expired">expired</a>, skip to the next <var>endpoint</var>.</p>
          <p class="note" role="note"><span>Note:</span> In this case, the user agent MAY remove <var>endpoint</var> from the <a data-link-type="dfn" href="#reporting-cache" id="ref-for-reporting-cacheâ âª">reporting cache</a>, or it may wait and collect garbage <i lang="fr">en masse</i> at some point in the future as described
  in <a href="#gc">Â§6.2 Garbage Collection</a>.</p>
         <li data-md="">
          <p>If <var>endpoint</var> is <a data-link-type="dfn" href="#endpoint-pending" id="ref-for-endpoint-pending">pending</a>, skip to the next <var>endpoint</var>.</p>
         <li data-md="">
          <p>If <a href="#does-endpoint-match-report">Â§4.2 Does endpoint match report?</a> returns "<code>Match</code>" when executed
  upon <var>endpoint</var> and <var>report</var>:</p>
          <ol>
           <li data-md="">
            <p>Append <var>report</var> to <var>endpoint map</var>âs list of reports for <var>endpoint</var>.</p>
           <li data-md="">
            <p>Skip to the next <var>report</var>.</p>
            <p class="note" role="note"><span>Note:</span> This ensures that each report is assigned to a single
  endpoint, even if it matches multiple. In order to ensure
  an even distribution across endpoints, the user agent SHOULD
  randomize the order in which it walks through endpoints.</p>
          </ol>
        </ol>
       <li data-md="">
        <p>If we reach this step, the <var>report</var> did not match any <a data-link-type="dfn" href="#endpoint" id="ref-for-endpointâ¡â£">endpoint</a> and the user agent MAY remove <var>report</var> from the <a data-link-type="dfn" href="#reporting-cache" id="ref-for-reporting-cacheâ â ">reporting cache</a> directly. Depending on load, the user agent MAY instead wait for <a href="#gc">Â§6.2 Garbage Collection</a> at some point in the future.</p>
      </ol>
     <li data-md="">
      <p>For each (<var>endpoint</var>, <var>reports</var>) pair in <var>endpoint map</var>, execute the
  following steps asynchronously:</p>
      <ol>
       <li data-md="">
        <p>Let <var>result</var> be the result of executing <a href="#try-delivery">Â§4.4 Attempt to deliver reports to endpoint</a> on <var>endpoint</var> and <var>reports</var>.</p>
       <li data-md="">
        <p>If <var>result</var> is "<code>Success</code>":</p>
        <ol>
         <li data-md="">
          <p>Set <var>endpoint</var>âs <code class="idl"><a data-link-type="idl" href="#dom-endpoint-failures" id="ref-for-dom-endpoint-failuresâ ">failures</a></code> to 0, and its <code class="idl"><a data-link-type="idl" href="#dom-endpoint-retry-after" id="ref-for-dom-endpoint-retry-afterâ¡">retry-after</a></code> to <code>null</code>.</p>
         <li data-md="">
          <p>Remove each <a data-link-type="dfn" href="#report" id="ref-for-reportâ â§">report</a> in <var>reports</var> from the <a data-link-type="dfn" href="#reporting-cache" id="ref-for-reporting-cacheâ â¡">reporting
  cache</a>.</p>
        </ol>
        <p>Otherwise, if <var>result</var> is "<code>Remove Endpoint</code>":</p>
        <ol>
         <li data-md="">
          <p>Remove <var>endpoint</var> from the reporting cache.</p>
          <p class="note" role="note"><span>Note:</span> <var>reports</var> remain in the reporting cache for potential
  delivery to other endpoints.</p>
        </ol>
        <p>Otherwise (if <var>result</var> is "<code>Failure</code>"):</p>
        <ol>
         <li data-md="">
          <p>Increment <var>endpoint</var>âs <code class="idl"><a data-link-type="idl" href="#dom-endpoint-failures" id="ref-for-dom-endpoint-failuresâ¡">failures</a></code>.</p>
         <li data-md="">
          <p>Set <var>endpoint</var>âs <code class="idl"><a data-link-type="idl" href="#dom-endpoint-retry-after" id="ref-for-dom-endpoint-retry-afterâ¢">retry-after</a></code> to a point in the future
  which the user agent chooses.</p>
          <p class="note" role="note"><span>Note:</span> We donât specify a particular algorithm here, but user
  agents are encouraged to employ some sort of exponential backoff
  algorithm which increases the retry period with the number of
  failures, with the addition of some random jitter to ensure that
  temporary failures donât lead to a crush of reports all being
  retried on the same schedule.</p>
          <p class="issue" id="issue-665ce7ee"><a class="self-link" href="#issue-665ce7ee"></a> Add in a reasonable reference describing a good algorithm.
  Wikipedia, if nothing else.</p>
        </ol>
      </ol>
    </ol>
    <p class="note" role="note"><span>Note:</span> User agents MAY decide to attempt delivery for only a subset of the
  collected reports or endpoints (because, for example, sending all the reports
  at once would consume an unreasonable amount of bandwidth, etc). As reports
  are only removed from the cache when theyâre successfully delivered, skipped
  reports will simply be delivered later.</p>
    <h3 class="heading settled algorithm" data-algorithm="Attempt to deliver reports to endpoint" data-level="4.4" id="try-delivery"><span class="secno">4.4. </span><span class="content"> Attempt to deliver <var>reports</var> to <var>endpoint</var> </span><a class="self-link" href="#try-delivery"></a></h3>
    <p>Given a list of <a data-link-type="dfn" href="#report" id="ref-for-reportâ â¨">reports</a> (<var>reports</var>) and an <a data-link-type="dfn" href="#endpoint" id="ref-for-endpointâ¡â¤">endpoint</a> (<var>endpoint</var>), this algorithm will construct a <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request" id="ref-for-concept-requestâ ">request</a>, and attempt to
  deliver it to <var>endpoint</var>. It returns "<code>Success</code>" if that delivery succeeds,
  "<code>Remove Endpoint</code>" if the endpoint explicitly removes itself as a reporting
  endpoint by sending a 410 response, and "<code>Failure</code>" otherwise.</p>
    <ol>
     <li data-md="">
      <p>Let <var>collection</var> be a new ECMAScript <code>Array</code> object <a data-link-type="biblio" href="#biblio-ecma-262">[ECMA-262]</a>.</p>
     <li data-md="">
      <p>For each <var>report</var> in <var>reports</var>:</p>
      <ol>
       <li data-md="">
        <p>Let <var>data</var> be a new ECMAScript <code>Object</code> with the following properties <a data-link-type="biblio" href="#biblio-ecma-262">[ECMA-262]</a>:</p>
        <dl>
         <dt data-md=""><code>age</code>
         <dd data-md="">
          <p>The number of milliseconds between <var>report</var>âs <a data-link-type="dfn" href="#report-timestamp" id="ref-for-report-timestampâ ">timestamp</a> and the current time.</p>
         <dt data-md=""><code>type</code>
         <dd data-md="">
          <p><var>report</var>âs <a data-link-type="dfn" href="#report-type" id="ref-for-report-typeâ ">type</a></p>
         <dt data-md=""><code>url</code>
         <dd data-md="">
          <p><var>report</var>âs <a data-link-type="dfn" href="#report-url" id="ref-for-report-urlâ ">url</a></p>
         <dt data-md=""><code>body</code>
         <dd data-md="">
          <p><var>report</var>âs <a data-link-type="dfn" href="#report-body" id="ref-for-report-bodyâ ">body</a></p>
        </dl>
        <p class="note" role="note"><span>Note:</span> Client clocks are unreliable and subject to skew. We therefore
  deliver an <code>age</code> attribute rather than an absolute timestamp. See
  also <a href="#fingerprinting-clock-skew">Â§9.2 Clock Skew</a></p>
       <li data-md="">
        <p>Increment <var>report</var>âs <a data-link-type="dfn" href="#report-attempts" id="ref-for-report-attemptsâ ">attempts</a>.</p>
       <li data-md="">
        <p>Append <var>data</var> to <var>collection</var>.</p>
      </ol>
     <li data-md="">
      <p>Let <var>request</var> be a new <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request" id="ref-for-concept-requestâ¡">request</a> with the following properties <a data-link-type="biblio" href="#biblio-fetch">[FETCH]</a>:</p>
      <dl>
       <dt data-md=""><code>url</code>
       <dd data-md="">
        <p><var>endpoint</var>âs <code class="idl"><a data-link-type="idl" href="#dom-endpoint-url" id="ref-for-dom-endpoint-urlâ¡">url</a></code></p>
       <dt data-md=""><code>header list</code>
       <dd data-md="">
        <p>A new <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-header-list" id="ref-for-concept-header-list">header list</a> containing a <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-header" id="ref-for-concept-headerâ¡">header</a> named
  "<code>Content-Type</code>" whose value is "<code>application/report</code>"</p>
       <dt data-md=""><code>client</code>
       <dd data-md="">
        <p><code>null</code></p>
       <dt data-md=""><code>window</code>
       <dd data-md="">
        <p>"<code>no-window</code>"</p>
       <dt data-md=""><code>skip-service-worker</code> flag
       <dd data-md="">
        <p>Set.</p>
       <dt data-md=""><code>initiator</code>
       <dd data-md="">
        <p>""</p>
       <dt data-md=""><code>type</code>
       <dd data-md="">
        <p>"<code>report</code>"</p>
       <dt data-md=""><code>destination</code>
       <dd data-md="">
        <p>""</p>
       <dt data-md=""><code>mode</code>
       <dd data-md="">
        <p>"<code>cors</code>"</p>
       <dt data-md=""><code>credentials</code>
       <dd data-md="">
        <p>"<code>include</code>"</p>
       <dt data-md=""><code>body</code>
       <dd data-md="">
        <p>The string resulting from executing the <code class="idl"><a data-link-type="idl" href="http://www.ecma-international.org/ecma-262/6.0/#sec-json.stringify" id="ref-for-sec-json.stringify">JSON.stringify()</a></code> algorithm
  on <var>collection</var> <a data-link-type="biblio" href="#biblio-ecma-262">[ECMA-262]</a></p>
      </dl>
      <p class="issue" id="issue-39dd1980"><a class="self-link" href="#issue-39dd1980"></a> The "<code>report</code>" type does not exist in Fetch. Talk to Anne.</p>
     <li data-md="">
      <p><a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#queue-a-task" id="ref-for-queue-a-task">Queue a task</a> to <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-fetch" id="ref-for-concept-fetch">fetch</a> <var>request</var>.</p>
     <li data-md="">
      <p><a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#wait-for-a-response" id="ref-for-wait-for-a-response">Wait for a response</a> (<var>response</var>).</p>
     <li data-md="">
      <p>If <var>response</var>âs <code>status</code> is an <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#ok-status" id="ref-for-ok-status">OK status</a> (200-299), return
  "<code>Success</code>".</p>
     <li data-md="">
      <p>If <var>response</var>âs <code>status</code> is <code>410 Gone</code> <a data-link-type="biblio" href="#biblio-rfc7231">[RFC7231]</a>, return "<code>Remove Endpoint</code>".</p>
     <li data-md="">
      <p>Return "<code>Failure</code>".</p>
    </ol>
   </section>
   <section>
    <h2 class="heading settled" data-level="5" id="observers"><span class="secno">5. </span><span class="content">Reporting Observers</span><a class="self-link" href="#observers"></a></h2>
     Each <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#environment-settings-object" id="ref-for-environment-settings-objectâ ">environment settings object</a> has an associated list of <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport="" id="registered-reporting-observers">registered reporting observers</dfn> (<code class="idl"><a data-link-type="idl" href="#reportingobserver" id="ref-for-reportingobserver">ReportingObserver</a></code> objects). 
    <h3 class="heading settled" data-level="5.1" id="interface-reporting-observer"><span class="secno">5.1. </span><span class="content">Interface <code class="idl"><a data-link-type="idl" href="#reportingobserver" id="ref-for-reportingobserverâ ">ReportingObserver</a></code></span><a class="self-link" href="#interface-reporting-observer"></a></h3>
<pre class="idl highlight def">[<a class="nv idl-code" data-link-type="extended-attribute" href="https://heycam.github.io/webidl/#NoInterfaceObject" id="ref-for-NoInterfaceObject">NoInterfaceObject</a>]
<span class="kt">interface</span> <dfn class="nv dfn-paneled idl-code" data-dfn-type="interface" data-export="" id="reportbody"><code>ReportBody</code></dfn> {
};

[<a class="nv idl-code" data-link-type="extended-attribute" href="https://heycam.github.io/webidl/#NoInterfaceObject" id="ref-for-NoInterfaceObjectâ ">NoInterfaceObject</a>]
<span class="kt">interface</span> <a class="nv idl-code" data-link-type="interface" href="#dom-report" id="ref-for-dom-report">Report</a> {
    <span class="kt">readonly</span> <span class="kt">attribute</span> <a class="n idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-DOMString" id="ref-for-idl-DOMString"><span class="kt">DOMString</span></a> <a class="nv idl-code" data-link-type="attribute" data-readonly="" data-type="DOMString" href="#dom-report-type" id="ref-for-dom-report-type">type</a>;
    <span class="kt">readonly</span> <span class="kt">attribute</span> <a class="n idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-DOMString" id="ref-for-idl-DOMStringâ "><span class="kt">DOMString</span></a> <a class="nv idl-code" data-link-type="attribute" data-readonly="" data-type="DOMString" href="#dom-report-url" id="ref-for-dom-report-url">url</a>;
    <span class="kt">readonly</span> <span class="kt">attribute</span> <a class="n" data-link-type="idl-name" href="#reportbody" id="ref-for-reportbody">ReportBody</a>? <a class="nv idl-code" data-link-type="attribute" data-readonly="" data-type="ReportBody?" href="#dom-report-body" id="ref-for-dom-report-body">body</a>;
};

[<a class="nv idl-code" data-link-type="constructor" href="#dom-reportingobserver-reportingobserver" id="ref-for-dom-reportingobserver-reportingobserver">Constructor</a>(<a class="n" data-link-type="idl-name" href="#callbackdef-reportingobservercallback" id="ref-for-callbackdef-reportingobservercallback">ReportingObserverCallback</a> <dfn class="nv idl-code" data-dfn-for="ReportingObserver/ReportingObserver(callback)" data-dfn-type="argument" data-export="" id="dom-reportingobserver-reportingobserver-callback-callback"><code>callback</code><a class="self-link" href="#dom-reportingobserver-reportingobserver-callback-callback"></a></dfn>)]
<span class="kt">interface</span> <dfn class="nv dfn-paneled idl-code" data-dfn-type="interface" data-export="" id="reportingobserver"><code>ReportingObserver</code></dfn> {
    <span class="kt">void</span> <a class="nv idl-code" data-link-type="method" href="#dom-reportingobserver-observe" id="ref-for-dom-reportingobserver-observe">observe</a>(<span class="kt">optional</span> <a class="n" data-link-type="idl-name" href="#dictdef-reportingobserveroptions" id="ref-for-dictdef-reportingobserveroptions">ReportingObserverOptions</a> <dfn class="nv idl-code" data-dfn-for="ReportingObserver/observe(options), ReportingObserver/observe()" data-dfn-type="argument" data-export="" id="dom-reportingobserver-observe-options-options"><code>options</code><a class="self-link" href="#dom-reportingobserver-observe-options-options"></a></dfn>);
    <span class="kt">void</span> <a class="nv idl-code" data-link-type="method" href="#dom-reportingobserver-disconnect" id="ref-for-dom-reportingobserver-disconnect">disconnect</a>();
};

<span class="kt">callback</span> <dfn class="nv dfn-paneled idl-code" data-dfn-type="callback" data-export="" id="callbackdef-reportingobservercallback"><code>ReportingObserverCallback</code></dfn> = <span class="kt">void</span> (<span class="kt">sequence</span>&lt;<a class="n" data-link-type="idl-name" href="#dom-report" id="ref-for-dom-reportâ ">Report</a>> <dfn class="nv idl-code" data-dfn-for="ReportingObserverCallback" data-dfn-type="argument" data-export="" id="dom-reportingobservercallback-reports"><code>reports</code><a class="self-link" href="#dom-reportingobservercallback-reports"></a></dfn>, <a class="n" data-link-type="idl-name" href="#reportingobserver" id="ref-for-reportingobserverâ¡">ReportingObserver</a> <dfn class="nv idl-code" data-dfn-for="ReportingObserverCallback" data-dfn-type="argument" data-export="" id="dom-reportingobservercallback-observer"><code>observer</code><a class="self-link" href="#dom-reportingobservercallback-observer"></a></dfn>);

<span class="kt">dictionary</span> <dfn class="nv dfn-paneled idl-code" data-dfn-type="dictionary" data-export="" id="dictdef-reportingobserveroptions"><code>ReportingObserverOptions</code></dfn> {
  <span class="kt">sequence</span>&lt;<a class="n idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-DOMString" id="ref-for-idl-DOMStringâ¡"><span class="kt">DOMString</span></a>> <dfn class="nv dfn-paneled idl-code" data-dfn-for="ReportingObserverOptions" data-dfn-type="dict-member" data-export="" data-type="sequence<DOMString> " id="dom-reportingobserveroptions-types"><code>types</code></dfn>;
};
</pre>
    <p>A <code class="idl"><a data-link-type="idl" href="#reportingobserver" id="ref-for-reportingobserverâ¢">ReportingObserver</a></code> object can be used to observe some types of <a data-link-type="dfn" href="#report" id="ref-for-reportâ¡âª">reports</a> from JavaScript when they are created.</p>
    <p class="issue" id="issue-a16fc4ce"><a class="self-link" href="#issue-a16fc4ce"></a> How do we specify which reports are observable?  Network-layer reports
  like CSP reports will not be.  Maybe thereâs something about the settings
  object?</p>
    <p>A <dfn class="dfn-paneled idl-code" data-dfn-type="interface" data-export="" id="dom-report"><code>Report</code></dfn> is the application exposed
  representation of a <a data-link-type="dfn" href="#report" id="ref-for-reportâ¡â ">report</a>. <dfn class="dfn-paneled idl-code" data-dfn-for="Report" data-dfn-type="attribute" data-export="" id="dom-report-type"><code>type</code></dfn> returns <a data-link-type="dfn" href="#report-type" id="ref-for-report-typeâ¡">type</a>, <dfn class="dfn-paneled idl-code" data-dfn-for="Report" data-dfn-type="attribute" data-export="" id="dom-report-url"><code>url</code></dfn> returns <a data-link-type="dfn" href="#report-url" id="ref-for-report-urlâ¡">url</a> and <dfn class="dfn-paneled idl-code" data-dfn-for="Report" data-dfn-type="attribute" data-export="" id="dom-report-body"><code>body</code></dfn> returns <a data-link-type="dfn" href="#report-body" id="ref-for-report-bodyâ¡">body</a>.</p>
    <p>Each <code class="idl"><a data-link-type="idl" href="#reportingobserver" id="ref-for-reportingobserverâ£">ReportingObserver</a></code> object has these associated concepts:</p>
    <ul>
     <li data-md="">
      <p>A <dfn class="dfn-paneled" data-dfn-for="ReportingObserver" data-dfn-type="dfn" data-noexport="" id="reportingobserver-callback">callback</dfn> set on creation.</p>
     <li data-md="">
      <p>An <code class="idl"><a data-link-type="idl" href="#dictdef-reportingobserveroptions" id="ref-for-dictdef-reportingobserveroptionsâ ">ReportingObserverOptions</a></code> dictionary called <dfn class="dfn-paneled" data-dfn-for="ReportingObserver" data-dfn-type="dfn" data-noexport="" id="reportingobserver-options">options</dfn>.</p>
     <li data-md="">
      <p>A list of <code class="idl"><a data-link-type="idl" href="#dom-report" id="ref-for-dom-reportâ¡">Report</a></code> objects called the <dfn class="dfn-paneled" data-dfn-for="ReportingObserver" data-dfn-type="dfn" data-lt="report list" data-noexport="" id="reportingobserver-report-list">report
list</dfn> that is initially empty.</p>
    </ul>
    <p>The <dfn class="dfn-paneled idl-code" data-dfn-for="ReportingObserver" data-dfn-type="constructor" data-export="" data-lt="ReportingObserver(callback)" id="dom-reportingobserver-reportingobserver"><code><code> ReportingObserver(<var>callback</var>)</code></code></dfn> constructor, when invoked, must
  create a new <code class="idl"><a data-link-type="idl" href="#reportingobserver" id="ref-for-reportingobserverâ¤">ReportingObserver</a></code> object with <a data-link-type="dfn" href="#reportingobserver-callback" id="ref-for-reportingobserver-callback">callback</a> set to <var>callback</var>, and then return it.</p>
    <p>The <dfn class="dfn-paneled idl-code" data-dfn-for="ReportingObserver" data-dfn-type="method" data-export="" data-lt="observe(options)|observe()" id="dom-reportingobserver-observe"><code><code>observe(<var>options</var>)</code></code></dfn> method, when invoked, must run these steps:</p>
    <ol>
     <li data-md="">
      <p>Set the <a data-link-type="dfn" href="https://dom.spec.whatwg.org/#context-object" id="ref-for-context-object">context object</a>âs <a data-link-type="dfn" href="#reportingobserver-options" id="ref-for-reportingobserver-options">options</a> to <var>options</var>.</p>
     <li data-md="">
      <p>If it is not already present, add the <a data-link-type="dfn" href="https://dom.spec.whatwg.org/#context-object" id="ref-for-context-objectâ ">context object</a> to the
 list of <a data-link-type="dfn" href="#registered-reporting-observers" id="ref-for-registered-reporting-observers">registered reporting observers</a> for the <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#environment-settings-object" id="ref-for-environment-settings-objectâ¡">environment
 settings object</a> associated with the <a data-link-type="dfn" href="https://dom.spec.whatwg.org/#context-object" id="ref-for-context-objectâ¡">context object</a>.</p>
    </ol>
    <p>The <dfn class="dfn-paneled idl-code" data-dfn-for="ReportingObserver" data-dfn-type="method" data-export="" id="dom-reportingobserver-disconnect"><code><code>disconnect()</code></code></dfn> method,
  when invoked, must run these steps:</p>
    <ol>
     <li data-md="">
      <p>If present, remove the <a data-link-type="dfn" href="https://dom.spec.whatwg.org/#context-object" id="ref-for-context-objectâ¢">context object</a> from the list of <a data-link-type="dfn" href="#registered-reporting-observers" id="ref-for-registered-reporting-observersâ ">registered reporting observers</a> for the <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#environment-settings-object" id="ref-for-environment-settings-objectâ¢">environment settings
 object</a> associated with the <a data-link-type="dfn" href="https://dom.spec.whatwg.org/#context-object" id="ref-for-context-objectâ£">context object</a>.</p>
    </ol>
    <h3 class="heading settled algorithm" data-algorithm="Notify reporting observers on settings with report." data-level="5.2" id="notify-observers"><span class="secno">5.2. </span><span class="content"> Notify reporting observers on <var>settings</var> with <var>report</var>. </span><a class="self-link" href="#notify-observers"></a></h3>
    <p>This algorithm makes <var>report</var>âs contents available to any registered <code class="idl"><a data-link-type="idl" href="#reportingobserver" id="ref-for-reportingobserverâ¥">ReportingObserver</a></code>s on the provided <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#environment-settings-object" id="ref-for-environment-settings-objectâ£">environment settings object</a> <var>settings</var>.</p>
    <ol>
     <li data-md="">
      <p>For each <code class="idl"><a data-link-type="idl" href="#reportingobserver" id="ref-for-reportingobserverâ¦">ReportingObserver</a></code> <var>observer</var> of the <a data-link-type="dfn" href="https://dom.spec.whatwg.org/#registered-observer" id="ref-for-registered-observer">registered
 observers</a> associated with <var>settings</var>:</p>
      <ol>
       <li data-md="">
        <p>If <var>observer</var>âs <a data-link-type="dfn" href="#reportingobserver-options" id="ref-for-reportingobserver-optionsâ ">options</a> has a <code class="idl"><a data-link-type="idl" href="#dom-reportingobserveroptions-types" id="ref-for-dom-reportingobserveroptions-types">types</a></code> member which does not contain <var>report</var>âs <a data-link-type="dfn" href="#report-type" id="ref-for-report-typeâ¢">type</a>, skip these
  sub-steps.</p>
       <li data-md="">
        <p>Create a new <code class="idl"><a data-link-type="idl" href="#dom-report" id="ref-for-dom-reportâ¢">Report</a></code> <var>r</var> with <code class="idl"><a data-link-type="idl" href="#dom-report-type" id="ref-for-dom-report-typeâ ">type</a></code> initialized to <var>report</var>âs <a data-link-type="dfn" href="#report-type" id="ref-for-report-typeâ£">type</a>, <code class="idl"><a data-link-type="idl" href="#dom-report-url" id="ref-for-dom-report-urlâ ">url</a></code> initialized to <var>report</var>âs <a data-link-type="dfn" href="#report-url" id="ref-for-report-urlâ¢">url</a>, and <code class="idl"><a data-link-type="idl" href="#dom-report-body" id="ref-for-dom-report-bodyâ ">body</a></code> initialized to <var>report</var>âs <a data-link-type="dfn" href="#report-body" id="ref-for-report-bodyâ¢">body</a>.</p>
        <p class="issue" id="issue-6311d126"><a class="self-link" href="#issue-6311d126"></a> how to polymorphically initialize body?</p>
       <li data-md="">
        <p>Add <var>r</var> to the end of <var>observer</var>âs <a data-link-type="dfn" href="#reportingobserver-report-list" id="ref-for-reportingobserver-report-list">report list</a>.</p>
      </ol>
     <li data-md="">
      <p><a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#queue-a-task" id="ref-for-queue-a-taskâ ">Queue a task</a> to <a href="#invoke-observers">Â§5.3 Invoke observers with notify list.</a> with a copy of the <a data-link-type="dfn" href="https://dom.spec.whatwg.org/#registered-observer" id="ref-for-registered-observerâ ">registered observers</a> associated with <var>settings</var>.</p>
    </ol>
    <h3 algorthm="" class="heading settled" data-level="5.3" id="invoke-observers"><span class="secno">5.3. </span><span class="content"> Invoke observers with <var>notify list</var>. </span><a class="self-link" href="#invoke-observers"></a></h3>
    <p>This algorithm invokes observer callback functions for reports of previously
  observed behavior.</p>
    <p class="note" role="note"><span>Note:</span> It is possible for the registered observers and their options to be
  different at this time than when reports were generated. It is important
  that we rely only on the state at the time of generation, for example to
  permit libraries to observe behavior only within the context of their own
  code.</p>
    <ol>
     <li data-md="">
      <p>For each <code class="idl"><a data-link-type="idl" href="#reportingobserver" id="ref-for-reportingobserverâ§">ReportingObserver</a></code> <var>observer</var> in <var>notify list</var>:</p>
      <ol>
       <li data-md="">
        <p>Let <var>reports</var> be a copy of <var>observer</var>âs <var>observer report list</var></p>
       <li data-md="">
        <p>Clear <var>observer</var>âs <var>observer report list</var></p>
       <li data-md="">
        <p><a data-link-type="dfn" href="https://heycam.github.io/webidl/#invoke-a-callback-function" id="ref-for-invoke-a-callback-function">invoke</a> <var>observer</var>âs <a data-link-type="dfn" href="#reportingobserver-callback" id="ref-for-reportingobserver-callbackâ ">callback</a> with a list of
  arguments consisting of <var>reports</var> and <var>observer</var>, and <var>observer</var> as the <a data-link-type="dfn" href="https://heycam.github.io/webidl/#dfn-callback-this-value" id="ref-for-dfn-callback-this-value">callback this value</a>.  If this throws an exception, <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#report-the-exception" id="ref-for-report-the-exception">report the
  exception</a>.</p>
      </ol>
    </ol>
   </section>
   <section>
    <h2 class="heading settled" data-level="6" id="implementation"><span class="secno">6. </span><span class="content">Implementation Considerations</span><a class="self-link" href="#implementation"></a></h2>
    <h3 class="heading settled" data-level="6.1" id="delivery"><span class="secno">6.1. </span><span class="content">Delivery</span><a class="self-link" href="#delivery"></a></h3>
    <p>The user agent SHOULD attempt to deliver reports as soon as possible to
  provide feedback to developers as quickly as possible. However, when this
  desire is balanced against the impact on the user, the user wins. With that
  in mind, the user agent MAY delay delivery of reports based on its knowledge
  of the userâs activities and context.</p>
    <p>For instance, the user agent SHOULD prioritize the transmission of reporting
  data lower than other network traffic. The userâs explicit activities on a
  website should preempt reporting traffic.</p>
    <p>The user agent MAY choose to withhold report delivery entirely until the user
  is on a fast, cheap network in order to prevent unnecessary data cost.</p>
    <p>The user agent MAY choose to prioritize reports from particular origins over
  others (perhaps those that the user visits most often?)</p>
    <h3 class="heading settled" data-level="6.2" id="gc"><span class="secno">6.2. </span><span class="content">Garbage Collection</span><a class="self-link" href="#gc"></a></h3>
    <p>Periodically, the user agent SHOULD walk through the cached <a data-link-type="dfn" href="#report" id="ref-for-reportâ¡â¡">reports</a> and <a data-link-type="dfn" href="#endpoint" id="ref-for-endpointâ¡â¥">endpoints</a>, and discard those that are no longer relevant. These
  include:</p>
    <ul>
     <li data-md="">
      <p><a data-link-type="dfn" href="#endpoint" id="ref-for-endpointâ¡â¦">endpoints</a> which are <a data-link-type="dfn" href="#endpoint-expired" id="ref-for-endpoint-expiredâ ">expired</a></p>
     <li data-md="">
      <p><a data-link-type="dfn" href="#endpoint" id="ref-for-endpointâ¡â§">endpoints</a> which have not been used in some arbitrary period of time
  (perhaps a ~week?)</p>
     <li data-md="">
      <p><a data-link-type="dfn" href="#endpoint" id="ref-for-endpointâ¡â¨">endpoints</a> whose <code class="idl"><a data-link-type="idl" href="#dom-endpoint-failures" id="ref-for-dom-endpoint-failuresâ¢">failures</a></code> exceed
  some user-agent-defined threshold (~5 seems reasonable)</p>
     <li data-md="">
      <p><a data-link-type="dfn" href="#report" id="ref-for-reportâ¡â¢">reports</a> whose <a data-link-type="dfn" href="#report-attempts" id="ref-for-report-attemptsâ¡">attempts</a> exceed
  some user-agent-defined threshold (~5 seems reasonable)</p>
     <li data-md="">
      <p><a data-link-type="dfn" href="#report" id="ref-for-reportâ¡â£">reports</a> which have not been delivered in some arbitrary period of
  time (perhaps ~2 days?)</p>
    </ul>
   </section>
   <section>
    <h2 class="heading settled" data-level="7" id="sample-reports"><span class="secno">7. </span><span class="content">Sample Reports</span><a class="self-link" href="#sample-reports"></a></h2>
    <div class="example" id="example-0af31647">
     <a class="self-link" href="#example-0af31647"></a> 
<pre>POST / HTTP/1.1
Host: example.com
...
Content-Type: application/report

[{
  "type": "csp",
  "age": 10,
  "url": "https://example.com/vulnerable-page/",
  "body": {
    "blocked": "https://evil.com/evil.js",
    "directive": "script-src",
    "policy": "script-src 'self'; object-src 'none'",
    "status": 200,
    "referrer": "https://evil.com/"
  }
}, {
  "type": "hpkp",
  "age": 32,
  "url": "https://www.example.com/",
  "body": {
    "date-time": "2014-04-06T13:00:50Z",
    "hostname": "www.example.com",
    "port": 443,
    "effective-expiration-date": "2014-05-01T12:40:50Z"
    "include-subdomains": false,
    "served-certificate-chain": [
      "-----BEGIN CERTIFICATE-----\n
      MIIEBDCCAuygAwIBAgIDAjppMA0GCSqGSIb3DQEBBQUAMEIxCzAJBgNVBAYTAlVT\n
      ...
      HFa9llF7b1cq26KqltyMdMKVvvBulRP/F/A8rLIQjcxz++iPAsbw+zOzlTvjwsto\n
      WHPbqCRiOwY1nQ2pM714A5AuTHhdUDqB1O6gyHA43LL5Z/qHQF1hwFGPa4NrzQU6\n
      yuGnBXj8ytqU0CwIPX4WecigUCAkVDNx\n
      -----END CERTIFICATE-----",
      ...
    ]
  }
}, {
  "type": "nel",
  "age": 29,
  "url": "https://example.com/thing.js",
  "body": {
    "referrer": "https://www.example.com/",
    "server-ip": "234.233.232.231",
    "protocol": "",
    "status-code": 0,
    "elapsed-time": 143,
    "age": 0,
    "type": "http.dns.name_not_resolved"
  }
}]
</pre>
    </div>
   </section>
   <section>
    <h2 class="heading settled" data-level="8" id="security"><span class="secno">8. </span><span class="content">Security Considerations</span><a class="self-link" href="#security"></a></h2>
    <h3 class="heading settled" data-level="8.1" id="capability-urls"><span class="secno">8.1. </span><span class="content">Capability URLs</span><a class="self-link" href="#capability-urls"></a></h3>
    <p>Some URLs are valuable in and of themselves. To mitigate the possibility
  that such URLs will be leaked via this reporting mechanism, we strip out
  credential information and fragment data from the URL we store as a <a data-link-type="dfn" href="#report" id="ref-for-reportâ¡â¤">report</a>âs originator. It is still possible, however, for a feature
  to unintentionally leak such data via a reportâs <a data-link-type="dfn" href="#report-body" id="ref-for-report-bodyâ£">body</a>. Implementers
  SHOULD ensure that URLs contained in a reportâs body are similarly stripped.</p>
   </section>
   <section>
    <h2 class="heading settled" data-level="9" id="privacy"><span class="secno">9. </span><span class="content">Privacy Considerations</span><a class="self-link" href="#privacy"></a></h2>
    <h3 class="heading settled" data-level="9.1" id="network-leakage"><span class="secno">9.1. </span><span class="content">Network Leakage</span><a class="self-link" href="#network-leakage"></a></h3>
    <p>Because this reporting mechanism is out-of-band, and doesnât rely on a page
  being open, itâs entirely possible for a report generated while a user is on
  one network to be sent while the user is on another network, even if they
  donât explicitly open the page from which the report was sent.</p>
    <p class="issue" id="issue-d777247f"><a class="self-link" href="#issue-d777247f"></a> Consider mitigations. For example, we could
  drop reports if we change from one network to another. <a href="https://github.com/WICG/BackgroundSync/issues/107">&lt;https://github.com/WICG/BackgroundSync/issues/107></a></p>
    <h3 class="heading settled" data-level="9.2" id="fingerprinting-clock-skew"><span class="secno">9.2. </span><span class="content">Clock Skew</span><a class="self-link" href="#fingerprinting-clock-skew"></a></h3>
    <p>Each report is delivered along with an <code>age</code> property, rather than the
  timestamp at which it was generated. We do this because each userâs local
  clock will be skewed from the clock on the server by an arbitrary amount.
  The difference between the time the report was generated and the time it
  was sent will be stable, regardless of clock skew, and we can avoid the
  fingerprinting risk of exposing the clock skew via this API.</p>
    <h3 class="heading settled" data-level="9.3" id="correlation"><span class="secno">9.3. </span><span class="content">Cross-origin correlation</span><a class="self-link" href="#correlation"></a></h3>
    <p>If multiple origins all use the same reporting endpoint, that endpoint may
  learn that a particular user has interacted with a certain set of websites,
  as it will receive origin-tagged reports from each. This doesnât seem worse
  than the status quo ability to track the same information from cooperative
  origins, and doesnât grant any new tracking ability above and beyond whatâs
  possible with <code>&lt;img></code> today.</p>
    <h3 class="heading settled" data-level="9.4" id="subdomains"><span class="secno">9.4. </span><span class="content">Subdomains</span><a class="self-link" href="#subdomains"></a></h3>
    <p>This specification allows any resource on a host to declare a set of reporting
  endpoints for that host and each of its subdomains. This doesnât have privacy
  implications in and of itself (beyond those noted in <a href="#clear-cache">Â§9.5 Clearing the reporting cache</a>), as the
  reporting endpoints themselves donât take any real action, as features will
  need to opt-into using these reporting endpoints explicitly. Those features
  certainly will have privacy implications, and should carefully consider
  whether they should be enabled across origin boundaries.</p>
    <h3 class="heading settled" data-level="9.5" id="clear-cache"><span class="secno">9.5. </span><span class="content">Clearing the reporting cache</span><a class="self-link" href="#clear-cache"></a></h3>
    <p>A user agentâs <a data-link-type="dfn" href="#reporting-cache" id="ref-for-reporting-cacheâ â¢">reporting cache</a> contains data about a userâs activity
  on the web, and user agents ought to handle this data carefully. In
  particular, if a user agent gives users the ability to clear their site data,
  browsing history, browsing cache, or similar, the user agent MUST also clear
  the <a data-link-type="dfn" href="#reporting-cache" id="ref-for-reporting-cacheâ â£">reporting cache</a>. Note that this includes both the pending reports
  themselves, as well as the endpoints to which they would be sent. Both MUST
  be cleared.</p>
    <h3 class="heading settled" data-level="9.6" id="disable"><span class="secno">9.6. </span><span class="content">Disabling Reporting</span><a class="self-link" href="#disable"></a></h3>
    <p>Reporting is, to some extent, a question of commons. In the aggregate, it
  seems useful for everyone for reports to be delivered. There is direct benefit
  to developers, as they can fix bugs, which means thereâs indirect benefit to
  users, as the sites they enjoy will be more stable and enjoyable. As a
  concrete example, Content Security Policy grants something like herd immunity
  to cross-site scripting attacks by alerting developers about potential holes
  in their sites' defenses. Fixing those bugs helps every user, even those whose
  user agents donât support Content Security Policy.</p>
    <p>The calculus, of course, depends on the nature of data thatâs being delivered,
  and the relative maliciousness of the reporting endpoints, but thatâs the
  value proposition in broad strokes.</p>
    <p>That said, it canât be the case that this general benefit be allowed to take
  priority over the ability of a user to individually opt-out of such a system.
  Sending reports costs bandwidth, and potentially could reveal some small
  amount of additional information above and beyond what a website can obtain
  in-band (<a data-link-type="biblio" href="#biblio-network-error-logging">[NETWORK-ERROR-LOGGING]</a>, for instance). User agents MUST allow
  users to disable reporting with some reasonable amount of granularity in order
  to maintain the priority of constituencies espoused in <a data-link-type="biblio" href="#biblio-html-design-principles">[HTML-DESIGN-PRINCIPLES]</a>.</p>
   </section>
   <section>
    <h2 class="heading settled" data-level="10" id="iana-considerations"><span class="secno">10. </span><span class="content">IANA Considerations</span><a class="self-link" href="#iana-considerations"></a></h2>
    <p>The permanent message header field registry should be updated
  with the following registration: <a data-link-type="biblio" href="#biblio-rfc3864">[RFC3864]</a></p>
    <h3 class="heading settled" data-level="10.1" id="iana-report-to"><span class="secno">10.1. </span><span class="content"> Report-To </span><a class="self-link" href="#iana-report-to"></a></h3>
    <dl>
     <dt data-md="">Header field name
     <dd data-md="">
      <p><code>Report-To</code></p>
     <dt data-md="">Applicable protocol
     <dd data-md="">
      <p>http</p>
     <dt data-md="">Status
     <dd data-md="">
      <p>standard</p>
     <dt data-md="">Author/Change controller
     <dd data-md="">
      <p>W3C</p>
     <dt data-md="">Specification document
     <dd data-md="">
      <p>This specification (see <a href="#header">Â§3.1 The Report-To HTTP Response Header Field</a>)</p>
    </dl>
   </section>
  </main>
<script>
(function() {
  "use strict";
  var collapseSidebarText = '<span aria-hidden="true">â</span> '
                          + '<span>Collapse Sidebar</span>';
  var expandSidebarText   = '<span aria-hidden="true">â</span> '
                          + '<span>Pop Out Sidebar</span>';
  var tocJumpText         = '<span aria-hidden="true">â</span> '
                          + '<span>Jump to Table of Contents</span>';

  var sidebarMedia = window.matchMedia('screen and (min-width: 78em)');
  var autoToggle   = function(e){ toggleSidebar(e.matches) };
  if(sidebarMedia.addListener) {
    sidebarMedia.addListener(autoToggle);
  }

  function toggleSidebar(on) {
    if (on == undefined) {
      on = !document.body.classList.contains('toc-sidebar');
    }

    /* Donât scroll to compensate for the ToC if weâre above it already. */
    var headY = 0;
    var head = document.querySelector('.head');
    if (head) {
      // terrible approx of "top of ToC"
      headY += head.offsetTop + head.offsetHeight;
    }
    var skipScroll = window.scrollY < headY;

    var toggle = document.getElementById('toc-toggle');
    var tocNav = document.getElementById('toc');
    if (on) {
      var tocHeight = tocNav.offsetHeight;
      document.body.classList.add('toc-sidebar');
      document.body.classList.remove('toc-inline');
      toggle.innerHTML = collapseSidebarText;
      if (!skipScroll) {
        window.scrollBy(0, 0 - tocHeight);
      }
      tocNav.focus();
      sidebarMedia.addListener(autoToggle); // auto-collapse when out of room
    }
    else {
      document.body.classList.add('toc-inline');
      document.body.classList.remove('toc-sidebar');
      toggle.innerHTML = expandSidebarText;
      if (!skipScroll) {
        window.scrollBy(0, tocNav.offsetHeight);
      }
      if (toggle.matches(':hover')) {
        /* Unfocus button when not using keyboard navigation,
           because I donât know where else to send the focus. */
        toggle.blur();
      }
    }
  }

  function createSidebarToggle() {
    /* Create the sidebar toggle in JS; it shouldnât exist when JS is off. */
    var toggle = document.createElement('a');
      /* This should probably be a button, but appearance isnât standards-track.*/
    toggle.id = 'toc-toggle';
    toggle.class = 'toc-toggle';
    toggle.href = '#toc';
    toggle.innerHTML = collapseSidebarText;

    sidebarMedia.addListener(autoToggle);
    var toggler = function(e) {
      e.preventDefault();
      sidebarMedia.removeListener(autoToggle); // persist explicit off states
      toggleSidebar();
      return false;
    }
    toggle.addEventListener('click', toggler, false);


    /* Get <nav id=toc-nav>, or make it if we donât have one. */
    var tocNav = document.getElementById('toc-nav');
    if (!tocNav) {
      tocNav = document.createElement('p');
      tocNav.id = 'toc-nav';
      /* Prepend for better keyboard navigation */
      document.body.insertBefore(tocNav, document.body.firstChild);
    }
    /* While weâre at it, make sure we have a Jump to Toc link. */
    var tocJump = document.getElementById('toc-jump');
    if (!tocJump) {
      tocJump = document.createElement('a');
      tocJump.id = 'toc-jump';
      tocJump.href = '#toc';
      tocJump.innerHTML = tocJumpText;
      tocNav.appendChild(tocJump);
    }

    tocNav.appendChild(toggle);
  }

  var toc = document.getElementById('toc');
  if (toc) {
    createSidebarToggle();
    toggleSidebar(sidebarMedia.matches);

    /* If the sidebar has been manually opened and is currently overlaying the text
       (window too small for the MQ to add the margin to body),
       then auto-close the sidebar once you click on something in there. */
    toc.addEventListener('click', function(e) {
      if(e.target.tagName.toLowerCase() == "a" && document.body.classList.contains('toc-sidebar') && !sidebarMedia.matches) {
        toggleSidebar(false);
      }
    }, false);
  }
  else {
    console.warn("Canât find Table of Contents. Please use <nav id='toc'> around the ToC.");
  }

  /* Wrap tables in case they overflow */
  var tables = document.querySelectorAll(':not(.overlarge) > table.data, :not(.overlarge) > table.index');
  var numTables = tables.length;
  for (var i = 0; i < numTables; i++) {
    var table = tables[i];
    var wrapper = document.createElement('div');
    wrapper.className = 'overlarge';
    table.parentNode.insertBefore(wrapper, table);
    wrapper.appendChild(table);
  }

})();
</script>
  <h2 class="no-num no-ref heading settled" id="index"><span class="content">Index</span><a class="self-link" href="#index"></a></h2>
  <h3 class="no-num no-ref heading settled" id="index-defined-here"><span class="content">Terms defined by this specification</span><a class="self-link" href="#index-defined-here"></a></h3>
  <ul class="index">
   <li><a href="#report-attempts">attempts</a><span>, in Â§2.3</span>
   <li>
    body
    <ul>
     <li><a href="#report-body">dfn for report</a><span>, in Â§2.3</span>
     <li><a href="#dom-report-body">attribute for Report</a><span>, in Â§5.1</span>
    </ul>
   <li><a href="#reportingobserver-callback">callback</a><span>, in Â§5.1</span>
   <li><a href="#client">client</a><span>, in Â§2.2</span>
   <li><a href="#dom-endpoint-clients">clients</a><span>, in Â§2.1</span>
   <li><a href="#dom-client-creation">creation</a><span>, in Â§2.2</span>
   <li><a href="#dom-reportingobserver-disconnect">disconnect()</a><span>, in Â§5.1</span>
   <li><a href="#endpoint">endpoint</a><span>, in Â§2.1</span>
   <li>
    expired
    <ul>
     <li><a href="#endpoint-expired">dfn for endpoint</a><span>, in Â§2.1</span>
     <li><a href="#client-expired">dfn for client</a><span>, in Â§2.2</span>
    </ul>
   <li><a href="#dom-endpoint-failures">failures</a><span>, in Â§2.1</span>
   <li>
    group
    <ul>
     <li><a href="#dom-client-group">attribute for client</a><span>, in Â§2.2</span>
     <li><a href="#report-group">dfn for report</a><span>, in Â§2.3</span>
     <li><a href="#reportto-group">dfn for ReportTo</a><span>, in Â§3.1.2</span>
    </ul>
   <li><a href="#reportto-includesubdomains">includeSubdomains</a><span>, in Â§3.1.3</span>
   <li><a href="#reportto-max-age">max-age</a><span>, in Â§3.1.4</span>
   <li><a href="#dom-reportingobserver-observe">observe()</a><span>, in Â§5.1</span>
   <li><a href="#dom-reportingobserver-observe">observe(options)</a><span>, in Â§5.1</span>
   <li><a href="#reportingobserver-options">options</a><span>, in Â§5.1</span>
   <li>
    origin
    <ul>
     <li><a href="#dom-client-origin">attribute for client</a><span>, in Â§2.2</span>
     <li><a href="#report-origin">dfn for report</a><span>, in Â§2.3</span>
    </ul>
   <li><a href="#endpoint-pending">pending</a><span>, in Â§2.1</span>
   <li><a href="#registered-reporting-observers">registered reporting observers</a><span>, in Â§5</span>
   <li><a href="#dom-report">Report</a><span>, in Â§5.1</span>
   <li><a href="#report">report</a><span>, in Â§2.3</span>
   <li><a href="#reportbody">ReportBody</a><span>, in Â§5.1</span>
   <li><a href="#reporting-cache">reporting cache</a><span>, in Â§2.4</span>
   <li><a href="#reportingobserver">ReportingObserver</a><span>, in Â§5.1</span>
   <li><a href="#callbackdef-reportingobservercallback">ReportingObserverCallback</a><span>, in Â§5.1</span>
   <li><a href="#dom-reportingobserver-reportingobserver">ReportingObserver(callback)</a><span>, in Â§5.1</span>
   <li><a href="#dictdef-reportingobserveroptions">ReportingObserverOptions</a><span>, in Â§5.1</span>
   <li><a href="#reportingobserver-report-list">report list</a><span>, in Â§5.1</span>
   <li><a href="#report-to">Report-To</a><span>, in Â§3.1</span>
   <li><a href="#dom-endpoint-retry-after">retry-after</a><span>, in Â§2.1</span>
   <li><a href="#dom-client-subdomains">subdomains</a><span>, in Â§2.2</span>
   <li><a href="#report-timestamp">timestamp</a><span>, in Â§2.3</span>
   <li><a href="#dom-client-ttl">ttl</a><span>, in Â§2.2</span>
   <li>
    type
    <ul>
     <li><a href="#report-type">dfn for report</a><span>, in Â§2.3</span>
     <li><a href="#dom-report-type">attribute for Report</a><span>, in Â§5.1</span>
    </ul>
   <li><a href="#dom-reportingobserveroptions-types">types</a><span>, in Â§5.1</span>
   <li>
    url
    <ul>
     <li><a href="#dom-endpoint-url">attribute for endpoint</a><span>, in Â§2.1</span>
     <li><a href="#report-url">dfn for report</a><span>, in Â§2.3</span>
     <li><a href="#reportto-url">dfn for ReportTo</a><span>, in Â§3.1.1</span>
     <li><a href="#dom-report-url">attribute for Report</a><span>, in Â§5.1</span>
    </ul>
  </ul>
  <h3 class="no-num no-ref heading settled" id="index-defined-elsewhere"><span class="content">Terms defined by reference</span><a class="self-link" href="#index-defined-elsewhere"></a></h3>
  <ul class="index">
   <li>
    <a data-link-type="biblio">[CSP3]</a> defines the following terms:
    <ul>
     <li><a href="https://w3c.github.io/webappsec-csp/#content-security-policy">content-security-policy</a>
     <li><a href="https://w3c.github.io/webappsec-csp/#directives-reporting">reports directive</a>
    </ul>
   <li>
    <a data-link-type="biblio">[DOM]</a> defines the following terms:
    <ul>
     <li><a href="https://dom.spec.whatwg.org/#context-object">context object</a>
     <li><a href="https://dom.spec.whatwg.org/#registered-observer">registered observer</a>
    </ul>
   <li>
    <a data-link-type="biblio">[ECMA-262]</a> defines the following terms:
    <ul>
     <li><a href="http://www.ecma-international.org/ecma-262/6.0/#sec-json.stringify">JSON.stringify()</a>
    </ul>
   <li>
    <a data-link-type="biblio">[FETCH]</a> defines the following terms:
    <ul>
     <li><a href="https://fetch.spec.whatwg.org/#concept-response-https-state">HTTPS state</a>
     <li><a href="https://fetch.spec.whatwg.org/#concept-fetch">fetch</a>
     <li><a href="https://fetch.spec.whatwg.org/#concept-header">header</a>
     <li><a href="https://fetch.spec.whatwg.org/#concept-header-list">header list</a>
     <li><a href="https://fetch.spec.whatwg.org/#concept-response-header-list">header list <small>(for response)</small></a>
     <li><a href="https://fetch.spec.whatwg.org/#main-fetch">main fetch</a>
     <li><a href="https://fetch.spec.whatwg.org/#concept-header-name">name</a>
     <li><a href="https://fetch.spec.whatwg.org/#ok-status">ok status</a>
     <li><a href="https://fetch.spec.whatwg.org/#concept-request">request</a>
     <li><a href="https://fetch.spec.whatwg.org/#concept-response">response</a>
     <li><a href="https://fetch.spec.whatwg.org/#concept-response-url">url</a>
     <li><a href="https://fetch.spec.whatwg.org/#concept-header-value">value</a>
     <li><a href="https://fetch.spec.whatwg.org/#wait-for-a-response">wait for a response</a>
    </ul>
   <li>
    <a data-link-type="biblio">[HTML]</a> defines the following terms:
    <ul>
     <li><a href="https://html.spec.whatwg.org/multipage/infrastructure.html#ascii-case-insensitive">ascii case-insensitive</a>
     <li><a href="https://html.spec.whatwg.org/multipage/webappapis.html#creation-url">creation url</a>
     <li><a href="https://html.spec.whatwg.org/multipage/webappapis.html#environment-settings-object">environment settings object</a>
     <li><a href="https://html.spec.whatwg.org/multipage/browsers.html#origin">origin</a>
     <li><a href="https://html.spec.whatwg.org/multipage/webappapis.html#queue-a-task">queue a task</a>
     <li><a href="https://html.spec.whatwg.org/multipage/webappapis.html#report-the-exception">report the exception</a>
    </ul>
   <li>
    <a data-link-type="biblio">[HTTP-JFV]</a> defines the following terms:
    <ul>
     <li><a href="https://greenbytes.de/tech/webdav/draft-reschke-http-jfv-02.html#rfc.section.2">json-field-value</a>
    </ul>
   <li>
    <a data-link-type="biblio">[RFC6797]</a> defines the following terms:
    <ul>
     <li><a href="https://tools.ietf.org/html/rfc6797#section-8.2">congruent match</a>
     <li><a href="https://tools.ietf.org/html/rfc6797#section-8.2">superdomain match</a>
    </ul>
   <li>
    <a data-link-type="biblio">[rfc7159]</a> defines the following terms:
    <ul>
     <li><a href="https://tools.ietf.org/html/rfc7159#section-2">json text</a>
    </ul>
   <li>
    <a data-link-type="biblio">[rfc7469]</a> defines the following terms:
    <ul>
     <li><a href="https://tools.ietf.org/html/rfc7469#section-2.1">public-key-pins</a>
    </ul>
   <li>
    <a data-link-type="biblio">[SECURE-CONTEXTS]</a> defines the following terms:
    <ul>
     <li><a href="https://w3c.github.io/webappsec-secure-contexts/#is-origin-trustworthy">potentially trustworthy</a>
    </ul>
   <li>
    <a data-link-type="biblio">[URL]</a> defines the following terms:
    <ul>
     <li><a href="https://url.spec.whatwg.org/#concept-url">URL</a>
     <li><a href="https://url.spec.whatwg.org/#dom-url-host">host</a>
     <li><a href="https://url.spec.whatwg.org/#concept-url-origin">origin of a url</a>
     <li><a href="https://url.spec.whatwg.org/#concept-url-password">password</a>
     <li><a href="https://url.spec.whatwg.org/#concept-url-parser">url parser</a>
     <li><a href="https://url.spec.whatwg.org/#concept-url-serializer">url serializer</a>
     <li><a href="https://url.spec.whatwg.org/#concept-url-username">username</a>
    </ul>
   <li>
    <a data-link-type="biblio">[WebIDL]</a> defines the following terms:
    <ul>
     <li><a href="https://heycam.github.io/webidl/#idl-DOMString">DOMString</a>
     <li><a href="https://heycam.github.io/webidl/#NoInterfaceObject">NoInterfaceObject</a>
     <li><a href="https://heycam.github.io/webidl/#dfn-callback-this-value">callback this value</a>
     <li><a href="https://heycam.github.io/webidl/#invoke-a-callback-function">invoke</a>
    </ul>
  </ul>
  <h2 class="no-num no-ref heading settled" id="references"><span class="content">References</span><a class="self-link" href="#references"></a></h2>
  <h3 class="no-num no-ref heading settled" id="normative"><span class="content">Normative References</span><a class="self-link" href="#normative"></a></h3>
  <dl>
   <dt id="biblio-dom">[DOM]
   <dd>Anne van Kesteren. <a href="https://dom.spec.whatwg.org/">DOM Standard</a>. Living Standard. URL: <a href="https://dom.spec.whatwg.org/">https://dom.spec.whatwg.org/</a>
   <dt id="biblio-ecma-262">[ECMA-262]
   <dd><a href="https://tc39.github.io/ecma262/">ECMAScript Language Specification</a>. URL: <a href="https://tc39.github.io/ecma262/">https://tc39.github.io/ecma262/</a>
   <dt id="biblio-fetch">[FETCH]
   <dd>Anne van Kesteren. <a href="https://fetch.spec.whatwg.org/">Fetch Standard</a>. Living Standard. URL: <a href="https://fetch.spec.whatwg.org/">https://fetch.spec.whatwg.org/</a>
   <dt id="biblio-html">[HTML]
   <dd>Anne van Kesteren; et al. <a href="https://html.spec.whatwg.org/multipage/">HTML Standard</a>. Living Standard. URL: <a href="https://html.spec.whatwg.org/multipage/">https://html.spec.whatwg.org/multipage/</a>
   <dt id="biblio-http-jfv">[HTTP-JFV]
   <dd>Julian Reschke. <a href="https://greenbytes.de/tech/webdav/draft-reschke-http-jfv-02.html">A JSON Encoding for HTTP Header Field Values</a>. URL: <a href="https://greenbytes.de/tech/webdav/draft-reschke-http-jfv-02.html">https://greenbytes.de/tech/webdav/draft-reschke-http-jfv-02.html</a>
   <dt id="biblio-rfc3864">[RFC3864]
   <dd>G. Klyne; M. Nottingham; J. Mogul. <a href="https://tools.ietf.org/html/rfc3864">Registration Procedures for Message Header Fields</a>. September 2004. Best Current Practice. URL: <a href="https://tools.ietf.org/html/rfc3864">https://tools.ietf.org/html/rfc3864</a>
   <dt id="biblio-rfc5234">[RFC5234]
   <dd>D. Crocker, Ed.; P. Overell. <a href="https://tools.ietf.org/html/rfc5234">Augmented BNF for Syntax Specifications: ABNF</a>. January 2008. Internet Standard. URL: <a href="https://tools.ietf.org/html/rfc5234">https://tools.ietf.org/html/rfc5234</a>
   <dt id="biblio-rfc6797">[RFC6797]
   <dd>J. Hodges; C. Jackson; A. Barth. <a href="https://tools.ietf.org/html/rfc6797">HTTP Strict Transport Security (HSTS)</a>. November 2012. Proposed Standard. URL: <a href="https://tools.ietf.org/html/rfc6797">https://tools.ietf.org/html/rfc6797</a>
   <dt id="biblio-rfc7159">[RFC7159]
   <dd>T. Bray, Ed.. <a href="https://tools.ietf.org/html/rfc7159">The JavaScript Object Notation (JSON) Data Interchange Format</a>. March 2014. Proposed Standard. URL: <a href="https://tools.ietf.org/html/rfc7159">https://tools.ietf.org/html/rfc7159</a>
   <dt id="biblio-rfc7231">[RFC7231]
   <dd>R. Fielding, Ed.; J. Reschke, Ed.. <a href="https://tools.ietf.org/html/rfc7231">Hypertext Transfer Protocol (HTTP/1.1): Semantics and Content</a>. June 2014. Proposed Standard. URL: <a href="https://tools.ietf.org/html/rfc7231">https://tools.ietf.org/html/rfc7231</a>
   <dt id="biblio-secure-contexts">[SECURE-CONTEXTS]
   <dd>Mike West; Yan Zhu. <a href="https://w3c.github.io/webappsec-secure-contexts/">Secure Contexts</a>. URL: <a href="https://w3c.github.io/webappsec-secure-contexts/">https://w3c.github.io/webappsec-secure-contexts/</a>
   <dt id="biblio-url">[URL]
   <dd>Anne van Kesteren. <a href="https://url.spec.whatwg.org/">URL Standard</a>. Living Standard. URL: <a href="https://url.spec.whatwg.org/">https://url.spec.whatwg.org/</a>
   <dt id="biblio-webidl">[WebIDL]
   <dd>Cameron McCormack; Boris Zbarsky; Tobie Langel. <a href="https://heycam.github.io/webidl/">Web IDL</a>. URL: <a href="https://heycam.github.io/webidl/">https://heycam.github.io/webidl/</a>
  </dl>
  <h3 class="no-num no-ref heading settled" id="informative"><span class="content">Informative References</span><a class="self-link" href="#informative"></a></h3>
  <dl>
   <dt id="biblio-csp3">[CSP3]
   <dd>Mike West. <a href="https://www.w3.org/TR/CSP3/">Content Security Policy Level 3</a>. URL: <a href="https://www.w3.org/TR/CSP3/">https://www.w3.org/TR/CSP3/</a>
   <dt id="biblio-html-design-principles">[HTML-DESIGN-PRINCIPLES]
   <dd>Anne van Kesteren; Maciej Stachowiak. <a href="https://www.w3.org/TR/html-design-principles/">HTML Design Principles</a>. 26 November 2007. WD. URL: <a href="https://www.w3.org/TR/html-design-principles/">https://www.w3.org/TR/html-design-principles/</a>
   <dt id="biblio-network-error-logging">[NETWORK-ERROR-LOGGING]
   <dd>Ilya Grigorik; et al. <a href="https://www.w3.org/TR/network-error-logging/">Network Error Logging</a>. URL: <a href="https://www.w3.org/TR/network-error-logging/">https://www.w3.org/TR/network-error-logging/</a>
   <dt id="biblio-rfc7469">[RFC7469]
   <dd>C. Evans; C. Palmer; R. Sleevi. <a href="https://tools.ietf.org/html/rfc7469">Public Key Pinning Extension for HTTP</a>. April 2015. Proposed Standard. URL: <a href="https://tools.ietf.org/html/rfc7469">https://tools.ietf.org/html/rfc7469</a>
  </dl>
  <h2 class="no-num no-ref heading settled" id="idl-index"><span class="content">IDL Index</span><a class="self-link" href="#idl-index"></a></h2>
<pre class="idl highlight def">[<a class="nv idl-code" data-link-type="extended-attribute" href="https://heycam.github.io/webidl/#NoInterfaceObject" id="ref-for-NoInterfaceObjectâ¡">NoInterfaceObject</a>]
<span class="kt">interface</span> <a class="nv" href="#reportbody"><code>ReportBody</code></a> {
};

[<a class="nv idl-code" data-link-type="extended-attribute" href="https://heycam.github.io/webidl/#NoInterfaceObject" id="ref-for-NoInterfaceObjectâ â ">NoInterfaceObject</a>]
<span class="kt">interface</span> <a class="nv idl-code" data-link-type="interface" href="#dom-report" id="ref-for-dom-reportâ£">Report</a> {
    <span class="kt">readonly</span> <span class="kt">attribute</span> <a class="n idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-DOMString" id="ref-for-idl-DOMStringâ¢"><span class="kt">DOMString</span></a> <a class="nv idl-code" data-link-type="attribute" data-readonly="" data-type="DOMString" href="#dom-report-type" id="ref-for-dom-report-typeâ¡">type</a>;
    <span class="kt">readonly</span> <span class="kt">attribute</span> <a class="n idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-DOMString" id="ref-for-idl-DOMStringâ â "><span class="kt">DOMString</span></a> <a class="nv idl-code" data-link-type="attribute" data-readonly="" data-type="DOMString" href="#dom-report-url" id="ref-for-dom-report-urlâ¡">url</a>;
    <span class="kt">readonly</span> <span class="kt">attribute</span> <a class="n" data-link-type="idl-name" href="#reportbody" id="ref-for-reportbodyâ ">ReportBody</a>? <a class="nv idl-code" data-link-type="attribute" data-readonly="" data-type="ReportBody?" href="#dom-report-body" id="ref-for-dom-report-bodyâ¡">body</a>;
};

[<a class="nv idl-code" data-link-type="constructor" href="#dom-reportingobserver-reportingobserver" id="ref-for-dom-reportingobserver-reportingobserverâ ">Constructor</a>(<a class="n" data-link-type="idl-name" href="#callbackdef-reportingobservercallback" id="ref-for-callbackdef-reportingobservercallbackâ ">ReportingObserverCallback</a> <a class="nv" href="#dom-reportingobserver-reportingobserver-callback-callback"><code>callback</code></a>)]
<span class="kt">interface</span> <a class="nv" href="#reportingobserver"><code>ReportingObserver</code></a> {
    <span class="kt">void</span> <a class="nv idl-code" data-link-type="method" href="#dom-reportingobserver-observe" id="ref-for-dom-reportingobserver-observeâ ">observe</a>(<span class="kt">optional</span> <a class="n" data-link-type="idl-name" href="#dictdef-reportingobserveroptions" id="ref-for-dictdef-reportingobserveroptionsâ¡">ReportingObserverOptions</a> <a class="nv" href="#dom-reportingobserver-observe-options-options"><code>options</code></a>);
    <span class="kt">void</span> <a class="nv idl-code" data-link-type="method" href="#dom-reportingobserver-disconnect" id="ref-for-dom-reportingobserver-disconnectâ ">disconnect</a>();
};

<span class="kt">callback</span> <a class="nv" href="#callbackdef-reportingobservercallback"><code>ReportingObserverCallback</code></a> = <span class="kt">void</span> (<span class="kt">sequence</span>&lt;<a class="n" data-link-type="idl-name" href="#dom-report" id="ref-for-dom-reportâ â ">Report</a>> <a class="nv" href="#dom-reportingobservercallback-reports"><code>reports</code></a>, <a class="n" data-link-type="idl-name" href="#reportingobserver" id="ref-for-reportingobserverâ¡â ">ReportingObserver</a> <a class="nv" href="#dom-reportingobservercallback-observer"><code>observer</code></a>);

<span class="kt">dictionary</span> <a class="nv" href="#dictdef-reportingobserveroptions"><code>ReportingObserverOptions</code></a> {
  <span class="kt">sequence</span>&lt;<a class="n idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-DOMString" id="ref-for-idl-DOMStringâ¡â "><span class="kt">DOMString</span></a>> <a class="nv" data-type="sequence<DOMString> " href="#dom-reportingobserveroptions-types"><code>types</code></a>;
};

</pre>
  <h2 class="no-num no-ref heading settled" id="issues-index"><span class="content">Issues Index</span><a class="self-link" href="#issues-index"></a></h2>
  <div style="counter-reset:issue">
   <div class="issue"> Fetch monkey patching. Talk to Anne.<a href="#issue-59ca7a64"> âµ </a></div>
   <div class="issue"> Add in a reasonable reference describing a good algorithm.
  Wikipedia, if nothing else.<a href="#issue-665ce7ee"> âµ </a></div>
   <div class="issue"> The "<code>report</code>" type does not exist in Fetch. Talk to Anne.<a href="#issue-39dd1980"> âµ </a></div>
   <div class="issue"> How do we specify which reports are observable?  Network-layer reports
  like CSP reports will not be.  Maybe thereâs something about the settings
  object?<a href="#issue-a16fc4ce"> âµ </a></div>
   <div class="issue"> how to polymorphically initialize body?<a href="#issue-6311d126"> âµ </a></div>
   <div class="issue"> Consider mitigations. For example, we could
  drop reports if we change from one network to another. <a href="https://github.com/WICG/BackgroundSync/issues/107">&lt;https://github.com/WICG/BackgroundSync/issues/107></a><a href="#issue-d777247f"> âµ </a></div>
  </div>
  <aside class="dfn-panel" data-for="endpoint">
   <b><a href="#endpoint">#endpoint</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-endpoint">1.1. Guarantees</a>
    <li><a href="#ref-for-endpointâ ">2.1. Endpoints</a> <a href="#ref-for-endpointâ¡">(2)</a> <a href="#ref-for-endpointâ¢">(3)</a> <a href="#ref-for-endpointâ£">(4)</a> <a href="#ref-for-endpointâ¤">(5)</a> <a href="#ref-for-endpointâ¥">(6)</a>
    <li><a href="#ref-for-endpointâ¦">2.2. Clients</a> <a href="#ref-for-endpointâ§">(2)</a> <a href="#ref-for-endpointâ¨">(3)</a>
    <li><a href="#ref-for-endpointâ âª">2.4. Storage</a> <a href="#ref-for-endpointâ â ">(2)</a> <a href="#ref-for-endpointâ â¡">(3)</a>
    <li><a href="#ref-for-endpointâ â¢">3.1. The Report-To HTTP Response Header Field</a>
    <li><a href="#ref-for-endpointâ â£">3.1.2. The group member</a> <a href="#ref-for-endpointâ â¤">(2)</a> <a href="#ref-for-endpointâ â¥">(3)</a>
    <li><a href="#ref-for-endpointâ â¦">3.1.4. The max-age member</a>
    <li><a href="#ref-for-endpointâ â§">3.2. 
    Process reporting endpoints for response to request </a> <a href="#ref-for-endpointâ â¨">(2)</a> <a href="#ref-for-endpointâ¡âª">(3)</a> <a href="#ref-for-endpointâ¡â ">(4)</a>
    <li><a href="#ref-for-endpointâ¡â¡">4.2. 
    Does endpoint match report? </a>
    <li><a href="#ref-for-endpointâ¡â¢">4.3. 
    Send reports </a> <a href="#ref-for-endpointâ¡â£">(2)</a>
    <li><a href="#ref-for-endpointâ¡â¤">4.4. 
    Attempt to deliver reports to endpoint </a>
    <li><a href="#ref-for-endpointâ¡â¥">6.2. Garbage Collection</a> <a href="#ref-for-endpointâ¡â¦">(2)</a> <a href="#ref-for-endpointâ¡â§">(3)</a> <a href="#ref-for-endpointâ¡â¨">(4)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-endpoint-url">
   <b><a href="#dom-endpoint-url">#dom-endpoint-url</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-endpoint-url">3.2. 
    Process reporting endpoints for response to request </a> <a href="#ref-for-dom-endpoint-urlâ ">(2)</a>
    <li><a href="#ref-for-dom-endpoint-urlâ¡">4.4. 
    Attempt to deliver reports to endpoint </a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-endpoint-failures">
   <b><a href="#dom-endpoint-failures">#dom-endpoint-failures</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-endpoint-failures">3.2. 
    Process reporting endpoints for response to request </a>
    <li><a href="#ref-for-dom-endpoint-failuresâ ">4.3. 
    Send reports </a> <a href="#ref-for-dom-endpoint-failuresâ¡">(2)</a>
    <li><a href="#ref-for-dom-endpoint-failuresâ¢">6.2. Garbage Collection</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-endpoint-retry-after">
   <b><a href="#dom-endpoint-retry-after">#dom-endpoint-retry-after</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-endpoint-retry-after">2.1. Endpoints</a>
    <li><a href="#ref-for-dom-endpoint-retry-afterâ ">3.2. 
    Process reporting endpoints for response to request </a>
    <li><a href="#ref-for-dom-endpoint-retry-afterâ¡">4.3. 
    Send reports </a> <a href="#ref-for-dom-endpoint-retry-afterâ¢">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-endpoint-clients">
   <b><a href="#dom-endpoint-clients">#dom-endpoint-clients</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-endpoint-clients">2.1. Endpoints</a>
    <li><a href="#ref-for-dom-endpoint-clientsâ ">3.2. 
    Process reporting endpoints for response to request </a> <a href="#ref-for-dom-endpoint-clientsâ¡">(2)</a> <a href="#ref-for-dom-endpoint-clientsâ¢">(3)</a>
    <li><a href="#ref-for-dom-endpoint-clientsâ£">4.2. 
    Does endpoint match report? </a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="endpoint-expired">
   <b><a href="#endpoint-expired">#endpoint-expired</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-endpoint-expired">4.3. 
    Send reports </a>
    <li><a href="#ref-for-endpoint-expiredâ ">6.2. Garbage Collection</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="endpoint-pending">
   <b><a href="#endpoint-pending">#endpoint-pending</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-endpoint-pending">4.3. 
    Send reports </a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="client">
   <b><a href="#client">#client</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-client">2.1. Endpoints</a> <a href="#ref-for-clientâ ">(2)</a>
    <li><a href="#ref-for-clientâ¡">2.2. Clients</a> <a href="#ref-for-clientâ¢">(2)</a> <a href="#ref-for-clientâ£">(3)</a> <a href="#ref-for-clientâ¤">(4)</a> <a href="#ref-for-clientâ¥">(5)</a> <a href="#ref-for-clientâ¦">(6)</a>
    <li><a href="#ref-for-clientâ§">3.2. 
    Process reporting endpoints for response to request </a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-client-origin">
   <b><a href="#dom-client-origin">#dom-client-origin</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-client-origin">3.2. 
    Process reporting endpoints for response to request </a> <a href="#ref-for-dom-client-originâ ">(2)</a> <a href="#ref-for-dom-client-originâ¡">(3)</a>
    <li><a href="#ref-for-dom-client-originâ¢">4.2. 
    Does endpoint match report? </a> <a href="#ref-for-dom-client-originâ£">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-client-subdomains">
   <b><a href="#dom-client-subdomains">#dom-client-subdomains</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-client-subdomains">3.2. 
    Process reporting endpoints for response to request </a> <a href="#ref-for-dom-client-subdomainsâ ">(2)</a>
    <li><a href="#ref-for-dom-client-subdomainsâ¡">3.3. 
    Parse reporting endpoint tuples from value </a>
    <li><a href="#ref-for-dom-client-subdomainsâ¢">4.2. 
    Does endpoint match report? </a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-client-group">
   <b><a href="#dom-client-group">#dom-client-group</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-client-group">2.3. Reports</a>
    <li><a href="#ref-for-dom-client-groupâ ">3.2. 
    Process reporting endpoints for response to request </a> <a href="#ref-for-dom-client-groupâ¡">(2)</a>
    <li><a href="#ref-for-dom-client-groupâ¢">3.3. 
    Parse reporting endpoint tuples from value </a>
    <li><a href="#ref-for-dom-client-groupâ£">4.2. 
    Does endpoint match report? </a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-client-ttl">
   <b><a href="#dom-client-ttl">#dom-client-ttl</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-client-ttl">2.2. Clients</a>
    <li><a href="#ref-for-dom-client-ttlâ ">3.2. 
    Process reporting endpoints for response to request </a> <a href="#ref-for-dom-client-ttlâ¡">(2)</a> <a href="#ref-for-dom-client-ttlâ¢">(3)</a>
    <li><a href="#ref-for-dom-client-ttlâ£">3.3. 
    Parse reporting endpoint tuples from value </a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-client-creation">
   <b><a href="#dom-client-creation">#dom-client-creation</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-client-creation">2.2. Clients</a>
    <li><a href="#ref-for-dom-client-creationâ ">3.2. 
    Process reporting endpoints for response to request </a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="client-expired">
   <b><a href="#client-expired">#client-expired</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-client-expired">2.1. Endpoints</a>
    <li><a href="#ref-for-client-expiredâ ">4.2. 
    Does endpoint match report? </a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="report">
   <b><a href="#report">#report</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-report">2.1. Endpoints</a>
    <li><a href="#ref-for-reportâ ">2.3. Reports</a> <a href="#ref-for-reportâ¡">(2)</a> <a href="#ref-for-reportâ¢">(3)</a> <a href="#ref-for-reportâ£">(4)</a> <a href="#ref-for-reportâ¤">(5)</a> <a href="#ref-for-reportâ¥">(6)</a> <a href="#ref-for-reportâ¦">(7)</a>
    <li><a href="#ref-for-reportâ§">2.4. Storage</a> <a href="#ref-for-reportâ¨">(2)</a> <a href="#ref-for-reportâ âª">(3)</a>
    <li><a href="#ref-for-reportâ â ">3.1.2. The group member</a>
    <li><a href="#ref-for-reportâ â¡">4. Report Delivery</a>
    <li><a href="#ref-for-reportâ â¢">4.1. 
    Queue data as type for endpoint group on settings </a> <a href="#ref-for-reportâ â£">(2)</a>
    <li><a href="#ref-for-reportâ â¤">4.2. 
    Does endpoint match report? </a>
    <li><a href="#ref-for-reportâ â¥">4.3. 
    Send reports </a> <a href="#ref-for-reportâ â¦">(2)</a> <a href="#ref-for-reportâ â§">(3)</a>
    <li><a href="#ref-for-reportâ â¨">4.4. 
    Attempt to deliver reports to endpoint </a>
    <li><a href="#ref-for-reportâ¡âª">5.1. Interface ReportingObserver</a> <a href="#ref-for-reportâ¡â ">(2)</a>
    <li><a href="#ref-for-reportâ¡â¡">6.2. Garbage Collection</a> <a href="#ref-for-reportâ¡â¢">(2)</a> <a href="#ref-for-reportâ¡â£">(3)</a>
    <li><a href="#ref-for-reportâ¡â¤">8.1. Capability URLs</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="report-body">
   <b><a href="#report-body">#report-body</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-report-body">4.1. 
    Queue data as type for endpoint group on settings </a>
    <li><a href="#ref-for-report-bodyâ ">4.4. 
    Attempt to deliver reports to endpoint </a>
    <li><a href="#ref-for-report-bodyâ¡">5.1. Interface ReportingObserver</a>
    <li><a href="#ref-for-report-bodyâ¢">5.2. 
    Notify reporting observers on settings with report. </a>
    <li><a href="#ref-for-report-bodyâ£">8.1. Capability URLs</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="report-url">
   <b><a href="#report-url">#report-url</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-report-url">4.1. 
    Queue data as type for endpoint group on settings </a>
    <li><a href="#ref-for-report-urlâ ">4.4. 
    Attempt to deliver reports to endpoint </a>
    <li><a href="#ref-for-report-urlâ¡">5.1. Interface ReportingObserver</a>
    <li><a href="#ref-for-report-urlâ¢">5.2. 
    Notify reporting observers on settings with report. </a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="report-origin">
   <b><a href="#report-origin">#report-origin</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-report-origin">4.1. 
    Queue data as type for endpoint group on settings </a>
    <li><a href="#ref-for-report-originâ ">4.2. 
    Does endpoint match report? </a> <a href="#ref-for-report-originâ¡">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="report-group">
   <b><a href="#report-group">#report-group</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-report-group">4.1. 
    Queue data as type for endpoint group on settings </a>
    <li><a href="#ref-for-report-groupâ ">4.2. 
    Does endpoint match report? </a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="report-type">
   <b><a href="#report-type">#report-type</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-report-type">4.1. 
    Queue data as type for endpoint group on settings </a>
    <li><a href="#ref-for-report-typeâ ">4.4. 
    Attempt to deliver reports to endpoint </a>
    <li><a href="#ref-for-report-typeâ¡">5.1. Interface ReportingObserver</a>
    <li><a href="#ref-for-report-typeâ¢">5.2. 
    Notify reporting observers on settings with report. </a> <a href="#ref-for-report-typeâ£">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="report-timestamp">
   <b><a href="#report-timestamp">#report-timestamp</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-report-timestamp">4.1. 
    Queue data as type for endpoint group on settings </a>
    <li><a href="#ref-for-report-timestampâ ">4.4. 
    Attempt to deliver reports to endpoint </a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="report-attempts">
   <b><a href="#report-attempts">#report-attempts</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-report-attempts">4.1. 
    Queue data as type for endpoint group on settings </a>
    <li><a href="#ref-for-report-attemptsâ ">4.4. 
    Attempt to deliver reports to endpoint </a>
    <li><a href="#ref-for-report-attemptsâ¡">6.2. Garbage Collection</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="reporting-cache">
   <b><a href="#reporting-cache">#reporting-cache</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-reporting-cache">3.1.4. The max-age member</a>
    <li><a href="#ref-for-reporting-cacheâ ">3.2. 
    Process reporting endpoints for response to request </a> <a href="#ref-for-reporting-cacheâ¡">(2)</a> <a href="#ref-for-reporting-cacheâ¢">(3)</a> <a href="#ref-for-reporting-cacheâ£">(4)</a>
    <li><a href="#ref-for-reporting-cacheâ¤">4. Report Delivery</a>
    <li><a href="#ref-for-reporting-cacheâ¥">4.1. 
    Queue data as type for endpoint group on settings </a> <a href="#ref-for-reporting-cacheâ¦">(2)</a>
    <li><a href="#ref-for-reporting-cacheâ§">4.3. 
    Send reports </a> <a href="#ref-for-reporting-cacheâ¨">(2)</a> <a href="#ref-for-reporting-cacheâ âª">(3)</a> <a href="#ref-for-reporting-cacheâ â ">(4)</a> <a href="#ref-for-reporting-cacheâ â¡">(5)</a>
    <li><a href="#ref-for-reporting-cacheâ â¢">9.5. Clearing the reporting cache</a> <a href="#ref-for-reporting-cacheâ â£">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="report-to">
   <b><a href="#report-to">#report-to</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-report-to">1.2. Examples</a> <a href="#ref-for-report-toâ ">(2)</a>
    <li><a href="#ref-for-report-toâ¡">3. Endpoint Delivery</a>
    <li><a href="#ref-for-report-toâ¢">3.2. 
    Process reporting endpoints for response to request </a> <a href="#ref-for-report-toâ£">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="reportto-url">
   <b><a href="#reportto-url">#reportto-url</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-reportto-url">1.2. Examples</a> <a href="#ref-for-reportto-urlâ ">(2)</a> <a href="#ref-for-reportto-urlâ¡">(3)</a> <a href="#ref-for-reportto-urlâ¢">(4)</a>
    <li><a href="#ref-for-reportto-urlâ£">3.3. 
    Parse reporting endpoint tuples from value </a> <a href="#ref-for-reportto-urlâ¤">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="reportto-group">
   <b><a href="#reportto-group">#reportto-group</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-reportto-group">1.2. Examples</a> <a href="#ref-for-reportto-groupâ ">(2)</a> <a href="#ref-for-reportto-groupâ¡">(3)</a> <a href="#ref-for-reportto-groupâ¢">(4)</a>
    <li><a href="#ref-for-reportto-groupâ£">3.3. 
    Parse reporting endpoint tuples from value </a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="reportto-includesubdomains">
   <b><a href="#reportto-includesubdomains">#reportto-includesubdomains</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-reportto-includesubdomains">3.3. 
    Parse reporting endpoint tuples from value </a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="reportto-max-age">
   <b><a href="#reportto-max-age">#reportto-max-age</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-reportto-max-age">1.2. Examples</a> <a href="#ref-for-reportto-max-ageâ ">(2)</a> <a href="#ref-for-reportto-max-ageâ¡">(3)</a> <a href="#ref-for-reportto-max-ageâ¢">(4)</a>
    <li><a href="#ref-for-reportto-max-ageâ£">3.3. 
    Parse reporting endpoint tuples from value </a> <a href="#ref-for-reportto-max-ageâ¤">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="registered-reporting-observers">
   <b><a href="#registered-reporting-observers">#registered-reporting-observers</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-registered-reporting-observers">5.1. Interface ReportingObserver</a> <a href="#ref-for-registered-reporting-observersâ ">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="reportbody">
   <b><a href="#reportbody">#reportbody</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-reportbody">5.1. Interface ReportingObserver</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="reportingobserver">
   <b><a href="#reportingobserver">#reportingobserver</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-reportingobserver">5. Reporting Observers</a>
    <li><a href="#ref-for-reportingobserverâ ">5.1. Interface ReportingObserver</a> <a href="#ref-for-reportingobserverâ¡">(2)</a> <a href="#ref-for-reportingobserverâ¢">(3)</a> <a href="#ref-for-reportingobserverâ£">(4)</a> <a href="#ref-for-reportingobserverâ¤">(5)</a>
    <li><a href="#ref-for-reportingobserverâ¥">5.2. 
    Notify reporting observers on settings with report. </a> <a href="#ref-for-reportingobserverâ¦">(2)</a>
    <li><a href="#ref-for-reportingobserverâ§">5.3. 
    Invoke observers with notify list. </a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="callbackdef-reportingobservercallback">
   <b><a href="#callbackdef-reportingobservercallback">#callbackdef-reportingobservercallback</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-callbackdef-reportingobservercallback">5.1. Interface ReportingObserver</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dictdef-reportingobserveroptions">
   <b><a href="#dictdef-reportingobserveroptions">#dictdef-reportingobserveroptions</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dictdef-reportingobserveroptions">5.1. Interface ReportingObserver</a> <a href="#ref-for-dictdef-reportingobserveroptionsâ ">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-reportingobserveroptions-types">
   <b><a href="#dom-reportingobserveroptions-types">#dom-reportingobserveroptions-types</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-reportingobserveroptions-types">5.2. 
    Notify reporting observers on settings with report. </a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-report">
   <b><a href="#dom-report">#dom-report</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-report">5.1. Interface ReportingObserver</a> <a href="#ref-for-dom-reportâ ">(2)</a> <a href="#ref-for-dom-reportâ¡">(3)</a>
    <li><a href="#ref-for-dom-reportâ¢">5.2. 
    Notify reporting observers on settings with report. </a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-report-type">
   <b><a href="#dom-report-type">#dom-report-type</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-report-type">5.1. Interface ReportingObserver</a>
    <li><a href="#ref-for-dom-report-typeâ ">5.2. 
    Notify reporting observers on settings with report. </a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-report-url">
   <b><a href="#dom-report-url">#dom-report-url</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-report-url">5.1. Interface ReportingObserver</a>
    <li><a href="#ref-for-dom-report-urlâ ">5.2. 
    Notify reporting observers on settings with report. </a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-report-body">
   <b><a href="#dom-report-body">#dom-report-body</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-report-body">5.1. Interface ReportingObserver</a>
    <li><a href="#ref-for-dom-report-bodyâ ">5.2. 
    Notify reporting observers on settings with report. </a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="reportingobserver-callback">
   <b><a href="#reportingobserver-callback">#reportingobserver-callback</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-reportingobserver-callback">5.1. Interface ReportingObserver</a>
    <li><a href="#ref-for-reportingobserver-callbackâ ">5.3. 
    Invoke observers with notify list. </a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="reportingobserver-options">
   <b><a href="#reportingobserver-options">#reportingobserver-options</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-reportingobserver-options">5.1. Interface ReportingObserver</a>
    <li><a href="#ref-for-reportingobserver-optionsâ ">5.2. 
    Notify reporting observers on settings with report. </a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="reportingobserver-report-list">
   <b><a href="#reportingobserver-report-list">#reportingobserver-report-list</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-reportingobserver-report-list">5.2. 
    Notify reporting observers on settings with report. </a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-reportingobserver-reportingobserver">
   <b><a href="#dom-reportingobserver-reportingobserver">#dom-reportingobserver-reportingobserver</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-reportingobserver-reportingobserver">5.1. Interface ReportingObserver</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-reportingobserver-observe">
   <b><a href="#dom-reportingobserver-observe">#dom-reportingobserver-observe</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-reportingobserver-observe">5.1. Interface ReportingObserver</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-reportingobserver-disconnect">
   <b><a href="#dom-reportingobserver-disconnect">#dom-reportingobserver-disconnect</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-reportingobserver-disconnect">5.1. Interface ReportingObserver</a>
   </ul>
  </aside>
<script>/* script-dfn-panel */

        document.body.addEventListener("click", function(e) {
            var queryAll = function(sel) { return [].slice.call(document.querySelectorAll(sel)); }
            // Find the dfn element or panel, if any, that was clicked on.
            var el = e.target;
            var target;
            var hitALink = false;
            while(el.parentElement) {
                if(el.tagName == "A") {
                    // Clicking on a link in a <dfn> shouldn't summon the panel
                    hitALink = true;
                }
                if(el.classList.contains("dfn-paneled")) {
                    target = "dfn";
                    break;
                }
                if(el.classList.contains("dfn-panel")) {
                    target = "dfn-panel";
                    break;
                }
                el = el.parentElement;
            }
            if(target != "dfn-panel") {
                // Turn off any currently "on" or "activated" panels.
                queryAll(".dfn-panel.on, .dfn-panel.activated").forEach(function(el){
                    el.classList.remove("on");
                    el.classList.remove("activated");
                });
            }
            if(target == "dfn" && !hitALink) {
                // open the panel
                var dfnPanel = document.querySelector(".dfn-panel[data-for='" + el.id + "']");
                if(dfnPanel) {
                    console.log(dfnPanel);
                    dfnPanel.classList.add("on");
                    var rect = el.getBoundingClientRect();
                    dfnPanel.style.left = window.scrollX + rect.right + 5 + "px";
                    dfnPanel.style.top = window.scrollY + rect.top + "px";
                    var panelRect = dfnPanel.getBoundingClientRect();
                    var panelWidth = panelRect.right - panelRect.left;
                    if(panelRect.right > document.body.scrollWidth && (rect.left - (panelWidth + 5)) > 0) {
                        // Reposition, because the panel is overflowing
                        dfnPanel.style.left = window.scrollX + rect.left - (panelWidth + 5) + "px";
                    }
                } else {
                    console.log("Couldn't find .dfn-panel[data-for='" + el.id + "']");
                }
            } else if(target == "dfn-panel") {
                // Switch it to "activated" state, which pins it.
                el.classList.add("activated");
                el.style.left = null;
                el.style.top = null;
            }

        });
        </script>